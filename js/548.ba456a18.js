"use strict";(self["webpackChunkbusiness_charts"]=self["webpackChunkbusiness_charts"]||[]).push([[548],{5548:function(e,a,n){n.r(a),n.d(a,{default:function(){return b}});var t=n(6768),l=n(144),r=n(8447),o=n(1114);n(4114),n(8111),n(2489);const i="orders";async function s(){const e=localStorage.getItem(i);return e?JSON.parse(e):[]}async function c(e){localStorage.setItem(i,JSON.stringify(e))}const d={async getAll(){return s()},async saveAll(e){c(e)},async load(){const e=localStorage.getItem(i);if(!e)return[];const a=JSON.parse(e);return a},async getById(e){},async add(e){const a=await this.load();a.push(e),localStorage.setItem(i,JSON.stringify(a))},async update(e){const a=await this.load(),n=a.findIndex(a=>a.id===e.id);-1!==n&&(a[n]=e),localStorage.setItem(i,JSON.stringify(a))},async remove(e){const a=await this.load(),n=a.filter(a=>a.id!==e);localStorage.setItem(i,JSON.stringify(n))},async removeAll(){await c([])}};var u=n(7017),m=n(9062),v=n(5922),f=n(1794);class p{constructor(){(0,o.A)(this,"_loadPartnersCommandHandler",void 0),(0,o.A)(this,"_loadDeliveryCarriesCommandHandler",void 0),this._loadPartnersCommandHandler=new m.x,this._loadDeliveryCarriesCommandHandler=new f.n}async handle(){await u.V.removeAll(),await d.removeAll(),await v.D.removeAll(),this._loadPartnersCommandHandler.handle(),this._loadDeliveryCarriesCommandHandler.handle()}}class h{constructor(e){(0,o.A)(this,"_fileService",void 0),this._fileService=e}async handle(e){await this._fileService.exportAll(e.includePartners,e.includeCarriers,e.includeOrders)}}class y{constructor(e){(0,o.A)(this,"_fileService",void 0),(0,o.A)(this,"_loadPartnersCommandHandler",void 0),(0,o.A)(this,"_loadDeliveryCarriesCommandHandler",void 0),this._fileService=e,this._loadPartnersCommandHandler=new m.x,this._loadDeliveryCarriesCommandHandler=new f.n}async handle(e){await this._fileService.importAll(e.file),this._loadPartnersCommandHandler.handle(),this._loadDeliveryCarriesCommandHandler.handle()}}n(4603),n(7566),n(8721);class g{async exportAll(e,a,n){const t={partners:[],orders:[],carriers:[]};e&&(t.partners=await u.V.getAll()),a&&(t.carriers=await v.D.getAll()),n&&(t.orders=await d.getAll());const l=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(l),o=document.createElement("a");o.href=r,o.download=`export-${(new Date).toISOString().slice(0,10)}.json`,o.click(),URL.revokeObjectURL(r)}async importAll(e){const a=await e.text(),n=JSON.parse(a);n.partners&&await u.V.saveAll(n.partners),n.orders&&await d.saveAll(n.orders),n.carriers&&await v.D.saveAll(n.carriers)}}function w(){const e=new g;return{exportDataCommandHandler:new h(e),importDataCommandHandler:new y(e),deleteDataCommandHandler:new p}}var C=(0,t.pM)({__name:"DataTransfer",setup(e){const{exportDataCommandHandler:a,importDataCommandHandler:n,deleteDataCommandHandler:o}=w();function i(e){const a=e.target.files?.[0];a&&n.handle({file:a})}return(e,n)=>{const s=(0,t.g2)("v-btn"),c=(0,t.g2)("v-file-input");return(0,t.uX)(),(0,t.CE)(t.FK,null,[n[1]||(n[1]=(0,t.Lk)("h1",null,"Data Transfer",-1)),n[2]||(n[2]=(0,t.Lk)("h2",null,"Export",-1)),(0,t.bF)(s,{color:"warning",onClick:(0,l.R1)(a).handle},{default:(0,t.k6)(()=>[...n[0]||(n[0]=[(0,t.eW)(" Export JSON ",-1)])]),_:1},8,["onClick"]),n[3]||(n[3]=(0,t.Lk)("h2",null,"Import",-1)),(0,t.bF)(c,{label:"JSON file",type:"file",accept:"application/json",onChange:i}),n[4]||(n[4]=(0,t.Lk)("h2",null,"Delete all data",-1)),(0,t.bF)(r.A,{name:"All Data","action-fn":(0,l.R1)(o).handle,mini:!1},null,8,["action-fn"])],64)}}});const _=C;var b=_},6022:function(e,a,n){n.d(a,{q:function(){return r}});var t=n(6768),l=n(144);function r(e,a){const n=(0,l.KR)(!1),r=(0,l.KR)(),o=(0,l.KR)(!1),i=(0,l.KR)(!1),s=(0,l.KR)(null),c=a?.autoReset??!0;function d(){for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)){const n=a;e[n]=""}o.value=!1,r.value?.resetValidation?.(),s.value=null}function u(a){for(const n in a)if(Object.prototype.hasOwnProperty.call(a,n)){const t=n;e[t]=a[t]}}async function m(){const e=await(r.value?.validate?.());return!!e?.valid}function v(){n.value=!1}async function f(a){s.value=null;const n=await m();if(n){i.value=!0;try{await a(e),v()}catch(t){console.error(t);const e=t instanceof Error?t.message:"string"===typeof t?t:String(t);s.value=e||"An unexpected error occurred"}finally{i.value=!1}}}return(0,t.wB)(n,e=>{!e&&c&&d()}),{dialog:n,formRef:r,validForm:o,loading:i,errorMessage:s,submit:f,validate:m,close:v,reset:d,setFormValues:u}}},8447:function(e,a,n){n.d(a,{A:function(){return d}});var t=n(6768),l=n(144),r=n(4232),o=n(6022),i=n(9605),s=(0,t.pM)({__name:"ConfirmDeleteModal",props:{name:{},actionFn:{type:Function},mini:{type:Boolean}},setup(e){const a=e,{tCap:n}=(0,i.S)(),s=(0,l.KR)(),{dialog:c,formRef:d,validForm:u,loading:m,close:v}=(0,o.q)(s);async function f(){m.value=!0,v(),await(0,t.dY)();try{await a.actionFn()}finally{m.value=!1}}return(a,o)=>{const i=(0,t.g2)("v-btn"),s=(0,t.g2)("v-row"),p=(0,t.g2)("v-container"),h=(0,t.g2)("v-form"),y=(0,t.g2)("v-card-text"),g=(0,t.g2)("v-spacer"),w=(0,t.g2)("v-card-actions"),C=(0,t.g2)("v-card"),_=(0,t.g2)("v-dialog");return(0,t.uX)(),(0,t.Wv)(_,{modelValue:(0,l.R1)(c),"onUpdate:modelValue":o[1]||(o[1]=e=>(0,l.i9)(c)?c.value=e:null),"max-width":"500"},{activator:(0,t.k6)(({props:a})=>[e.mini?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.Wv)(i,(0,t.v6)({key:0},a,{color:"red",text:(0,l.R1)(n)("common.delete"),"prepend-icon":"mdi-trash-can",variant:"flat"}),null,16,["text"])),e.mini?((0,t.uX)(),(0,t.Wv)(i,(0,t.v6)({key:1},a,{color:"red",icon:"mdi-trash-can",variant:"text",density:"compact"}),null,16)):(0,t.Q3)("",!0)]),default:(0,t.k6)(()=>[(0,t.bF)(C,{title:`${(0,l.R1)(n)("common.delete")} ${e.name}`},{default:(0,t.k6)(()=>[(0,t.bF)(y,null,{default:(0,t.k6)(()=>[(0,t.bF)(h,{ref_key:"formRef",ref:d,modelValue:(0,l.R1)(u),"onUpdate:modelValue":o[0]||(o[0]=e=>(0,l.i9)(u)?u.value=e:null)},{default:(0,t.k6)(()=>[(0,t.bF)(p,null,{default:(0,t.k6)(()=>[(0,t.bF)(s,null,{default:(0,t.k6)(()=>[(0,t.Lk)("h2",null,(0,r.v_)((0,l.R1)(n)("common.confirmDeleteMessage"))+" "+(0,r.v_)(e.name),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(w,null,{default:(0,t.k6)(()=>[(0,t.bF)(g),(0,t.bF)(i,{variant:"tonal",color:"red",text:(0,l.R1)(n)("common.delete"),loading:(0,l.R1)(m),disabled:(0,l.R1)(m),onClick:f},null,8,["text","loading","disabled"]),(0,t.bF)(i,{text:(0,l.R1)(n)("common.cancel"),disabled:(0,l.R1)(m),onClick:(0,l.R1)(v)},null,8,["text","disabled","onClick"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}});const c=s;var d=c}}]);
//# sourceMappingURL=548.ba456a18.js.map