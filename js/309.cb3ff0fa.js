"use strict";(self["webpackChunkbusiness_charts"]=self["webpackChunkbusiness_charts"]||[]).push([[309],{2389:function(e,t,a){a.d(t,{R:function(){return s},i:function(){return n}});var r=a(1176);function n(e){return e.type===r.t.Supplier}function s(e){return e.type===r.t.B2BCustomer}},7299:function(e,t,a){a.d(t,{X:function(){return k}});a(8111),a(2489),a(1701);var r=a(6768),n=a(2261),s=a(1176),i=a(2819),d=a(1114),o=a(8114),l=a(7017),u=a(8568),c=a(2496),p=a(676);class m{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=(0,u.j)(e.contactName,e.activity,e.businessName);return e.email&&""!==e.email.trim()&&t.addEmail((0,c.tp)(e.email,!0)),e.phone&&""!==e.phone.trim()&&t.addPhone((0,c.FX)(e.phone,!0)),e.address&&t.addAddress((0,p.F)(e.address.street,e.address.city,e.address.zip,e.address.country,!0)),await l.V.add(t),this._partnersStore.add(i.M.toDTO(t)),t}}var v=a(600);class h{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=(0,v.F)(e.contactName,e.deliveryCarrierId,e.businessName);return e.email&&""!=e.email.trim()&&t.addEmail((0,c.tp)(e.email,!0)),e.phone&&""!=e.phone.trim()&&t.addPhone((0,c.FX)(e.phone,!0)),e.address&&t.addAddress((0,p.F)(e.address.street,e.address.city,e.address.zip,e.address.country,!0)),await l.V.add(t),this._partnersStore.add(i.M.toDTO(t)),t}}class y{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.id);if(t)return t.updateData(e.contactName,e.businessName),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class _{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getSupplierById(e.id);if(t)return t.updateData(e.contactName,e.businessName,e.activity),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class f{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getB2BCustomerById(e.id);if(t)return t.updateData(e.contactName,e.businessName),t.deliveryCarrierId=e.deliveryCarrierId,await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class b{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){await l.V.remove(e.id),this._partnersStore.remove(e.id)}}class S{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,c.tp)(e.email,e.isPrimary,e.name);return t.addEmail(a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class g{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,c.tp)(e.email,e.isPrimary,e.name);return t.editEmail(e.emailId,a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class w{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(t)return t.removeEmail(e.emailId),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class V{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,c.FX)(e.phone,e.isPrimary,e.name);return t.addPhone(a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class C{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,c.FX)(e.phone,e.isPrimary,e.name);return t.editPhone(e.phoneId,a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class I{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(t)return t.removePhone(e.phoneId),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class B{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,p.F)(e.street,e.city,e.zip,e.country,e.isPrimary,e.name);return t.addAddress(a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class N{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,p.F)(e.street,e.city,e.zip,e.country,e.isPrimary,e.name);return t.editAddress(e.addressId,a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class R{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(t)return t.removeAddress(e.addressId),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}function k(){const e=(0,o.g)(),{all:t}=(0,n.bP)(e);return{b2bCustomers:(0,r.EW)(()=>t.value.filter(e=>e.type===s.t.B2BCustomer).map(i.M.toModel)),suppliers:(0,r.EW)(()=>t.value.filter(e=>e.type===s.t.Supplier).map(i.M.toModel)),createSupplierCommandHandler:new m(e),createB2BCustomerCommandHandler:new h(e),editSupplierCommandHandler:new _(e),editB2BCustomerCommandHandler:new f(e),editPartnerCommandHandler:new y(e),addEmailCommandHandler:new S(e),editEmailCommandHandler:new g(e),removeEmailCommandHandler:new w(e),addPhoneCommandHandler:new V(e),editPhoneCommandHandler:new C(e),removePhoneCommandHandler:new I(e),addAddressCommandHandler:new B(e),editAddressCommandHandler:new N(e),removeAddressCommandHandler:new R(e),deletePartnerCommandHandler:new b(e)}}},8425:function(e,t,a){a.d(t,{B:function(){return u},x:function(){return l}});a(8111),a(2489),a(1701);var r=a(6252),n=a(2819),s=a(1176),i=a(2844),d=a(8114),o=a(6768);function l(e){const t=(0,i.h)(),a=t.getById(e);if(a)return r.i.toModel(a)}function u(e){const t=(0,d.g)(),a=(0,o.EW)(()=>t.getByType(s.t.B2BCustomer).filter(t=>t.deliveryCarrierId===e).map(n.M.toModel));return{b2bCustomers:a}}},9149:function(e,t,a){a.d(t,{A:function(){return h}});var r=a(6768),n=a(144),s=a(4232),i=a(2389),d=a(8269),o=a(7299),l=a(6022),u=a(9605),c=a(7648),p=a(8571),m=(0,r.pM)({__name:"EditPartnerModal",props:{partner:{},mini:{type:Boolean}},setup(e){const{editSupplierCommandHandler:t,editB2BCustomerCommandHandler:a}=(0,o.X)(),{carriers:m}=(0,c.J)(),{tCap:v,t:h}=(0,u.S)(),y=e,_=(0,n.Kh)({businessName:"",contactName:"",activity:"",deliveryCarrierId:""});function f(e){return{title:e.name,value:e.id,subtitle:e.primaryLocation?.value??""}}const{dialog:b,formRef:S,validForm:g,loading:w,errorMessage:V,close:C,submit:I}=(0,l.q)(_);(0,r.wB)(b,e=>{e&&y.partner&&(_.businessName=y.partner.businessName??"",_.contactName=y.partner.contactName,B.value&&(_.activity=B.value.activity??""),N.value&&(_.deliveryCarrierId=N.value.deliveryCarrierId??""))});const B=(0,r.EW)(()=>y.partner&&(0,i.i)(y.partner)?y.partner:void 0),N=(0,r.EW)(()=>y.partner&&(0,i.R)(y.partner)?y.partner:void 0);async function R(){await I(async e=>{B.value?t.handle({id:y.partner?.id??"",contactName:e.contactName,activity:e.activity,businessName:e.businessName}):N.value&&a.handle({id:y.partner?.id??"",contactName:e.contactName,businessName:e.businessName,deliveryCarrierId:e.deliveryCarrierId})})}return(t,a)=>{const i=(0,r.g2)("v-btn"),o=(0,r.g2)("v-text-field"),l=(0,r.g2)("v-col"),u=(0,r.g2)("v-autocomplete"),c=(0,r.g2)("v-row"),y=(0,r.g2)("v-alert"),I=(0,r.g2)("v-container"),k=(0,r.g2)("v-form"),F=(0,r.g2)("v-card-text"),A=(0,r.g2)("v-spacer"),M=(0,r.g2)("v-card-actions"),P=(0,r.g2)("v-card"),D=(0,r.g2)("v-dialog");return(0,r.uX)(),(0,r.Wv)(D,{modelValue:(0,n.R1)(b),"onUpdate:modelValue":a[5]||(a[5]=e=>(0,n.i9)(b)?b.value=e:null),"max-width":"500"},{activator:(0,r.k6)(({props:t})=>[e.mini?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.Wv)(i,(0,r.v6)({key:0},t,{color:"surface-variant",text:`${(0,n.R1)(v)("common.edit")} ${(0,n.R1)(h)("partner.partner")}`,"prepend-icon":"mdi-pencil",variant:"flat"}),null,16,["text"])),e.mini?((0,r.uX)(),(0,r.Wv)(i,(0,r.v6)({key:1},t,{color:"surface-variant",icon:"mdi-pencil",variant:"text",density:"compact"}),null,16)):(0,r.Q3)("",!0)]),default:(0,r.k6)(()=>[(0,r.bF)(P,{title:`${(0,n.R1)(v)("common.edit")} ${_.businessName}`},{default:(0,r.k6)(()=>[(0,r.bF)(F,null,{default:(0,r.k6)(()=>[(0,r.bF)(k,{ref_key:"formRef",ref:S,modelValue:(0,n.R1)(g),"onUpdate:modelValue":a[4]||(a[4]=e=>(0,n.i9)(g)?g.value=e:null)},{default:(0,r.k6)(()=>[(0,r.bF)(I,{class:"pa-0",fluid:""},{default:(0,r.k6)(()=>[(0,r.bF)(c,{dense:""},{default:(0,r.k6)(()=>[(0,r.bF)(l,{cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(o,{modelValue:_.contactName,"onUpdate:modelValue":a[0]||(a[0]=e=>_.contactName=e),label:(0,n.R1)(v)("partner.contactName"),rules:[(0,n.R1)(d.mw),(0,n.R1)(d.oE)(3,50)]},null,8,["modelValue","label","rules"])]),_:1}),(0,r.bF)(l,{cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(o,{modelValue:_.businessName,"onUpdate:modelValue":a[1]||(a[1]=e=>_.businessName=e),label:(0,n.R1)(v)("partner.businessName"),rules:[(0,n.R1)(d.Ru)(50)]},null,8,["modelValue","label","rules"])]),_:1}),B.value?((0,r.uX)(),(0,r.Wv)(l,{key:0,cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(o,{modelValue:_.activity,"onUpdate:modelValue":a[2]||(a[2]=e=>_.activity=e),label:(0,n.R1)(v)("partner.activity"),rules:[(0,n.R1)(d.mw),(0,n.R1)(d.Ru)(50)]},null,8,["modelValue","label","rules"])]),_:1})):(0,r.Q3)("",!0),N.value?((0,r.uX)(),(0,r.Wv)(l,{key:1,cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{modelValue:_.deliveryCarrierId,"onUpdate:modelValue":a[3]||(a[3]=e=>_.deliveryCarrierId=e),"item-props":f,label:"Carrier",items:(0,n.R1)(m)},{"append-inner":(0,r.k6)(()=>[(0,r.bF)(p.A,{mini:""})]),_:1},8,["modelValue","items"])]),_:1})):(0,r.Q3)("",!0)]),_:1}),(0,n.R1)(V)?((0,r.uX)(),(0,r.Wv)(y,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-2"},{default:(0,r.k6)(()=>[(0,r.eW)((0,s.v_)((0,n.R1)(V)),1)]),_:1})):(0,r.Q3)("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,r.bF)(M,null,{default:(0,r.k6)(()=>[(0,r.bF)(A),(0,r.bF)(i,{variant:"tonal",color:"indigo",text:(0,n.R1)(v)("common.save"),loading:(0,n.R1)(w),disabled:!(0,n.R1)(g)||(0,n.R1)(w),onClick:R},null,8,["text","loading","disabled"]),(0,r.bF)(i,{text:(0,n.R1)(v)("common.cancel"),color:"red",disabled:(0,n.R1)(w),onClick:(0,n.R1)(C)},null,8,["text","disabled","onClick"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}});const v=m;var h=v}}]);
//# sourceMappingURL=309.cb3ff0fa.js.map