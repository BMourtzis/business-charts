"use strict";(self["webpackChunkbusiness_charts"]=self["webpackChunkbusiness_charts"]||[]).push([[309],{2389:function(e,t,a){a.d(t,{R:function(){return s},i:function(){return n}});var r=a(1176);function n(e){return e.type===r.t.Supplier}function s(e){return e.type===r.t.B2BCustomer}},7299:function(e,t,a){a.d(t,{X:function(){return R}});a(8111),a(2489),a(1701);var r=a(6768),n=a(2261),s=a(1176),i=a(2819),d=a(1114),o=a(8114),l=a(7017),u=a(8568),c=a(2496),p=a(676);class m{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=(0,u.j)(e.contactName,e.activity,e.businessName);return e.email&&""!==e.email.trim()&&t.addEmail((0,c.tp)(e.email,!0)),e.phone&&""!==e.phone.trim()&&t.addPhone((0,c.FX)(e.phone,!0)),e.address&&t.addAddress((0,p.F)(e.address.street,e.address.city,e.address.zip,e.address.country,!0)),await l.V.add(t),this._partnersStore.add(i.M.toDTO(t)),t}}var v=a(600);class h{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=(0,v.F)(e.contactName,e.deliveryCarrierId,e.businessName);return e.email&&""!=e.email.trim()&&t.addEmail((0,c.tp)(e.email,!0)),e.phone&&""!=e.phone.trim()&&t.addPhone((0,c.FX)(e.phone,!0)),e.address&&t.addAddress((0,p.F)(e.address.street,e.address.city,e.address.zip,e.address.country,!0)),await l.V.add(t),this._partnersStore.add(i.M.toDTO(t)),t}}class y{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.id);if(t)return t.updateData(e.contactName,e.businessName),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class _{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getSupplierById(e.id);if(t)return t.updateData(e.contactName,e.businessName,e.activity),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class f{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getB2BCustomerById(e.id);if(t)return t.updateData(e.contactName,e.businessName),t.deliveryCarrierId=e.deliveryCarrierId,await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class b{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){await l.V.remove(e.id),this._partnersStore.remove(e.id)}}class g{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,c.tp)(e.email,e.isPrimary,e.name);return t.addEmail(a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class S{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,c.tp)(e.email,e.isPrimary,e.name);return t.editEmail(e.emailId,a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class w{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(t)return t.removeEmail(e.emailId),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class V{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,c.FX)(e.phone,e.isPrimary,e.name);return t.addPhone(a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class C{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,c.FX)(e.phone,e.isPrimary,e.name);return t.editPhone(e.phoneId,a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class I{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(t)return t.removePhone(e.phoneId),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class B{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,p.F)(e.street,e.city,e.zip,e.country,e.isPrimary,e.name);return t.addAddress(a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class N{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(!t)return;const a=(0,p.F)(e.street,e.city,e.zip,e.country,e.isPrimary,e.name);return t.editAddress(e.addressId,a),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}class k{constructor(e=(0,o.g)()){(0,d.A)(this,"_partnersStore",void 0),this._partnersStore=e}async handle(e){const t=await l.V.getById(e.partnerId);if(t)return t.removeAddress(e.addressId),await l.V.update(t),this._partnersStore.update(i.M.toDTO(t)),t}}function R(){const e=(0,o.g)(),{all:t}=(0,n.bP)(e);return{b2bCustomers:(0,r.EW)(()=>t.value.filter(e=>e.type===s.t.B2BCustomer).map(i.M.toModel)),suppliers:(0,r.EW)(()=>t.value.filter(e=>e.type===s.t.Supplier).map(i.M.toModel)),createSupplierCommandHandler:new m(e),createB2BCustomerCommandHandler:new h(e),editSupplierCommandHandler:new _(e),editB2BCustomerCommandHandler:new f(e),editPartnerCommandHandler:new y(e),addEmailCommandHandler:new g(e),editEmailCommandHandler:new S(e),removeEmailCommandHandler:new w(e),addPhoneCommandHandler:new V(e),editPhoneCommandHandler:new C(e),removePhoneCommandHandler:new I(e),addAddressCommandHandler:new B(e),editAddressCommandHandler:new N(e),removeAddressCommandHandler:new k(e),deletePartnerCommandHandler:new b(e)}}},8425:function(e,t,a){a.d(t,{B:function(){return u},x:function(){return l}});a(8111),a(2489),a(1701);var r=a(6252),n=a(2819),s=a(1176),i=a(2844),d=a(8114),o=a(6768);function l(e){const t=(0,i.h)(),a=t.getById(e);if(a)return r.i.toModel(a)}function u(e){const t=(0,d.g)(),a=(0,o.EW)(()=>t.getByType(s.t.B2BCustomer).filter(t=>t.deliveryCarrierId===e).map(n.M.toModel));return{b2bCustomers:a}}},9149:function(e,t,a){a.d(t,{A:function(){return h}});var r=a(6768),n=a(144),s=a(4232),i=a(2389),d=a(7299),o=a(6022),l=a(9605),u=a(7648),c=a(7160),p=a(8571),m=(0,r.pM)({__name:"EditPartnerModal",props:{partner:{},mini:{type:Boolean}},setup(e){const{maxLength:t,required:a,rangeLength:m}=(0,c.A)(),{editSupplierCommandHandler:v,editB2BCustomerCommandHandler:h}=(0,d.X)(),{carriers:y}=(0,u.J)(),{tCap:_,t:f}=(0,l.S)(),b=e,g=(0,n.Kh)({businessName:"",contactName:"",activity:"",deliveryCarrierId:""});function S(e){return{title:e.name,value:e.id,subtitle:e.primaryLocation?.value??""}}const{dialog:w,formRef:V,validForm:C,loading:I,errorMessage:B,close:N,submit:k}=(0,o.q)(g);(0,r.wB)(w,e=>{e&&b.partner&&(g.businessName=b.partner.businessName??"",g.contactName=b.partner.contactName,R.value&&(g.activity=R.value.activity??""),A.value&&(g.deliveryCarrierId=A.value.deliveryCarrierId??""))});const R=(0,r.EW)(()=>b.partner&&(0,i.i)(b.partner)?b.partner:void 0),A=(0,r.EW)(()=>b.partner&&(0,i.R)(b.partner)?b.partner:void 0);async function F(){await k(async e=>{R.value?v.handle({id:b.partner?.id??"",contactName:e.contactName,activity:e.activity,businessName:e.businessName}):A.value&&h.handle({id:b.partner?.id??"",contactName:e.contactName,businessName:e.businessName,deliveryCarrierId:e.deliveryCarrierId})})}return(i,d)=>{const o=(0,r.g2)("v-btn"),l=(0,r.g2)("v-text-field"),u=(0,r.g2)("v-col"),c=(0,r.g2)("v-autocomplete"),v=(0,r.g2)("v-row"),h=(0,r.g2)("v-alert"),b=(0,r.g2)("v-container"),k=(0,r.g2)("v-form"),M=(0,r.g2)("v-card-text"),P=(0,r.g2)("v-spacer"),D=(0,r.g2)("v-card-actions"),H=(0,r.g2)("v-card"),T=(0,r.g2)("v-dialog");return(0,r.uX)(),(0,r.Wv)(T,{modelValue:(0,n.R1)(w),"onUpdate:modelValue":d[5]||(d[5]=e=>(0,n.i9)(w)?w.value=e:null),"max-width":"500"},{activator:(0,r.k6)(({props:t})=>[e.mini?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.Wv)(o,(0,r.v6)({key:0},t,{color:"surface-variant",text:`${(0,n.R1)(_)("common.edit")} ${(0,n.R1)(f)("partner.partner")}`,"prepend-icon":"mdi-pencil",variant:"flat"}),null,16,["text"])),e.mini?((0,r.uX)(),(0,r.Wv)(o,(0,r.v6)({key:1},t,{color:"surface-variant",icon:"mdi-pencil",variant:"text",density:"compact"}),null,16)):(0,r.Q3)("",!0)]),default:(0,r.k6)(()=>[(0,r.bF)(H,{title:`${(0,n.R1)(_)("common.edit")} ${g.businessName}`},{default:(0,r.k6)(()=>[(0,r.bF)(M,null,{default:(0,r.k6)(()=>[(0,r.bF)(k,{ref_key:"formRef",ref:V,modelValue:(0,n.R1)(C),"onUpdate:modelValue":d[4]||(d[4]=e=>(0,n.i9)(C)?C.value=e:null)},{default:(0,r.k6)(()=>[(0,r.bF)(b,{class:"pa-0",fluid:""},{default:(0,r.k6)(()=>[(0,r.bF)(v,{dense:""},{default:(0,r.k6)(()=>[(0,r.bF)(u,{cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(l,{modelValue:g.contactName,"onUpdate:modelValue":d[0]||(d[0]=e=>g.contactName=e),label:(0,n.R1)(_)("partner.contactName"),rules:[(0,n.R1)(a),(0,n.R1)(m)(3,50)]},null,8,["modelValue","label","rules"])]),_:1}),(0,r.bF)(u,{cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(l,{modelValue:g.businessName,"onUpdate:modelValue":d[1]||(d[1]=e=>g.businessName=e),label:(0,n.R1)(_)("partner.businessName"),rules:[(0,n.R1)(t)(50)]},null,8,["modelValue","label","rules"])]),_:1}),R.value?((0,r.uX)(),(0,r.Wv)(u,{key:0,cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(l,{modelValue:g.activity,"onUpdate:modelValue":d[2]||(d[2]=e=>g.activity=e),label:(0,n.R1)(_)("partner.activity"),rules:[(0,n.R1)(a),(0,n.R1)(t)(50)]},null,8,["modelValue","label","rules"])]),_:1})):(0,r.Q3)("",!0),A.value?((0,r.uX)(),(0,r.Wv)(u,{key:1,cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{modelValue:g.deliveryCarrierId,"onUpdate:modelValue":d[3]||(d[3]=e=>g.deliveryCarrierId=e),"item-props":S,label:"Carrier",items:(0,n.R1)(y)},{"append-inner":(0,r.k6)(()=>[(0,r.bF)(p.A,{mini:""})]),_:1},8,["modelValue","items"])]),_:1})):(0,r.Q3)("",!0)]),_:1}),(0,n.R1)(B)?((0,r.uX)(),(0,r.Wv)(h,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-2"},{default:(0,r.k6)(()=>[(0,r.eW)((0,s.v_)((0,n.R1)(B)),1)]),_:1})):(0,r.Q3)("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,r.bF)(D,null,{default:(0,r.k6)(()=>[(0,r.bF)(P),(0,r.bF)(o,{variant:"tonal",color:"indigo",text:(0,n.R1)(_)("common.save"),loading:(0,n.R1)(I),disabled:!(0,n.R1)(C)||(0,n.R1)(I),onClick:F},null,8,["text","loading","disabled"]),(0,r.bF)(o,{text:(0,n.R1)(_)("common.cancel"),color:"red",disabled:(0,n.R1)(I),onClick:(0,n.R1)(N)},null,8,["text","disabled","onClick"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}});const v=m;var h=v}}]);
//# sourceMappingURL=309.922d1457.js.map