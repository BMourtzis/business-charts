{"version":3,"file":"js/779.2e999f93.js","mappings":"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","sources":["webpack://business-charts/./src/infrastructure/repositories/orderRepository.local.ts","webpack://business-charts/./src/infrastructure/services/filePersistenceService.ts","webpack://business-charts/./src/application/commands/exportAllDataCommand.ts","webpack://business-charts/./src/application/commands/importAllDataCommand.ts","webpack://business-charts/./src/presentation/composables/useDataManagement.ts","webpack://business-charts/./src/presentation/views/DataTransfer.vue?4a18","webpack://business-charts/./src/presentation/views/DataTransfer.vue","webpack://business-charts/./src/presentation/views/DataTransfer.vue?23df"],"sourcesContent":["import { Order, OrderDTO } from \"@/domain/models/order\";\nimport { Repository } from \"./type\";\n\nconst STORAGE_KEY = 'orders';\n\nasync function loadDTOs(): Promise<OrderDTO[]> {\n    const json = localStorage.getItem(STORAGE_KEY);\n    if (!json) return [];\n    return JSON.parse(json);\n}\n\nasync function saveDTOs(dtos: OrderDTO[]): Promise<void> {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(dtos));\n}\n\n//TODO: update this to save with DTO\nexport const orderRepository: Repository<Order, OrderDTO> = {\n    async getAll() {\n        return loadDTOs();\n    },\n    async saveAll(orderDtos) {\n        saveDTOs(orderDtos)\n    },\n    async load() {\n        const json = localStorage.getItem(STORAGE_KEY);\n        if (!json) return [];\n        const plain = JSON.parse(json);\n        return plain;\n    },\n    async add(order) {\n        const all = await this.load();\n        all.push(order);\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(all));\n    },\n\n    async update(order) {\n        const all = await this.load();\n        const i = all.findIndex((o: Order) => o.id === order.id);\n        if (i !== -1) all[i] = order;\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(all));\n    },\n\n    async remove(id) {\n        const all = await this.load();\n        const filtered = all.filter((o: Order) => o.id !== id);\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(filtered));\n    },\n};","import { partnerRepository } from '@/infrastructure/repositories/partnerRepository.local';\nimport { orderRepository } from '@/infrastructure/repositories/orderRepository.local';\n\nexport class FilePersistenceService {\n    async exportAll() {\n        const data = {\n            partners: await partnerRepository.getAll(),\n            orders: await orderRepository.getAll(),\n        }\n\n        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' })\n        const url = URL.createObjectURL(blob)\n        const a = document.createElement('a')\n        a.href = url\n        a.download = `export-${new Date().toISOString().slice(0, 10)}.json`\n        a.click()\n        URL.revokeObjectURL(url)\n    }\n\n    async importAll(file: File) {\n        const text = await file.text();\n        const data = JSON.parse(text);\n\n        if (data.partners) {\n            await partnerRepository.saveAll(data.partners);\n        }\n\n        if (data.orders) {\n            await orderRepository.saveAll(data.orders);\n        }\n    }\n}","import { FilePersistenceService } from '@/infrastructure/services/filePersistenceService';\n\nexport async function exportAllDataCommand(): Promise<void> {\n    const fileService = new FilePersistenceService();\n    await fileService.exportAll()\n}","import { FilePersistenceService } from '@/infrastructure/services/filePersistenceService';\nimport { loadPartners } from './loadPartnersCommand';\n\nexport async function importAllDataCommand(file: File): Promise<void> {\n    const fileService = new FilePersistenceService();\n    await fileService.importAll(file);\n\n    //TODO: probably encapsulate all the calls to a separate command\n    loadPartners();\n}","import { exportAllDataCommand } from '@/application/commands/exportAllDataCommand';\nimport { importAllDataCommand } from '@/application/commands/importAllDataCommand';\n\nexport function useDataManagement() {\n    return { \n        exportData: exportAllDataCommand, \n        importData: (file: File) => importAllDataCommand(file)\n    };\n}","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, unref as _unref, withCtx as _withCtx, createVNode as _createVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { useDataManagement } from '@/presentation/composables/useDataManagement'\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'DataTransfer',\n  setup(__props) {\n\nconst { exportData, importData } = useDataManagement()\n\nfunction onImport(e: Event) {\n    const file = (e.target as HTMLInputElement).files?.[0]\n    if (file) importData(file)\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_btn = _resolveComponent(\"v-btn\")!\n  const _component_v_file_input = _resolveComponent(\"v-file-input\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _cache[1] || (_cache[1] = _createElementVNode(\"h1\", null, \"Data Transfer\", -1)),\n    _cache[2] || (_cache[2] = _createElementVNode(\"h2\", null, \"Export\", -1)),\n    _createVNode(_component_v_btn, {\n      color: \"warning\",\n      onClick: _unref(exportData)\n    }, {\n      default: _withCtx(() => [...(_cache[0] || (_cache[0] = [\n        _createTextVNode(\" Export JSON \", -1)\n      ]))]),\n      _: 1\n    }, 8, [\"onClick\"]),\n    _cache[3] || (_cache[3] = _createElementVNode(\"h2\", null, \"Import\", -1)),\n    _createVNode(_component_v_file_input, {\n      label: \"JSON file\",\n      type: \"file\",\n      accept: \"application/json\",\n      onChange: onImport\n    })\n  ], 64))\n}\n}\n\n})","<template>\n  <h1>Data Transfer</h1>\n  <h2>Export</h2>\n  <v-btn \n    color=\"warning\"\n    @click=\"exportData\"\n  >\n    Export JSON\n  </v-btn>\n  <h2>Import</h2>\n  <v-file-input\n    label=\"JSON file\"\n    type=\"file\"\n    accept=\"application/json\"\n    @change=\"onImport\" \n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { useDataManagement } from '@/presentation/composables/useDataManagement'\n\nconst { exportData, importData } = useDataManagement()\n\nfunction onImport(e: Event) {\n    const file = (e.target as HTMLInputElement).files?.[0]\n    if (file) importData(file)\n}\n</script>\n\n<style scoped></style>","import script from \"./DataTransfer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DataTransfer.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["STORAGE_KEY","async","loadDTOs","json","localStorage","getItem","JSON","parse","saveDTOs","dtos","setItem","stringify","orderRepository","getAll","saveAll","orderDtos","load","plain","add","order","all","this","push","update","i","findIndex","o","id","remove","filtered","filter","FilePersistenceService","exportAll","data","partners","partnerRepository","orders","blob","Blob","type","url","URL","createObjectURL","a","document","createElement","href","download","Date","toISOString","slice","click","revokeObjectURL","importAll","file","text","exportAllDataCommand","fileService","importAllDataCommand","loadPartners","useDataManagement","exportData","importData","_defineComponent","__name","setup","__props","onImport","e","target","files","_ctx","_cache","_component_v_btn","_resolveComponent","_component_v_file_input","_openBlock","_createElementBlock","_Fragment","_createElementVNode","_createVNode","color","onClick","_unref","default","_withCtx","_createTextVNode","_","label","accept","onChange","__exports__"],"sourceRoot":""}