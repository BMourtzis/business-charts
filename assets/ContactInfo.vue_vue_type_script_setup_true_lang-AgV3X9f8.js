import{j as le,d as N,K as ve,f as ie,g as ne,C as E,k as de,w as se,m as z,l as i,u as e,p as j,q as l,e as t,x as A,y as te,z as k,A as D,o as u,E as P,L as fe,c as V,B as F,J as _e,M as ye,N as pe,H as Y,I as Z}from"./index-GJmNcSpu.js";import{u as ae}from"./usePartners-CFSt2nES.js";import{u as re,b as we,a as Ie}from"./AddressLink.vue_vue_type_script_setup_true_lang-blf97eZh.js";import{_ as ee}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-DMZbPiBp.js";function Pe(o){return{form:le({type:o,name:"",value:"",isPrimary:!1})}}function Ce(){return{form:le({type:"address",name:"",street:"",city:"",zip:"",country:"",isPrimary:!1})}}function be(o){if(o==="partner"){const{addAddressCommandHandler:d,editAddressCommandHandler:f}=ae();return{add:async a=>{await d.handle({partnerId:a.ownerId,street:a.street,city:a.city,zip:a.zip,country:a.country,name:a.name,isPrimary:a.isPrimary})},edit:async a=>{await f.handle({partnerId:a.ownerId,addressId:a.addressId,street:a.street,city:a.city,zip:a.zip,country:a.country,name:a.name,isPrimary:a.isPrimary})}}}if(o==="deliveryCarrier"){const{addAddressCommandHandler:d,editAddressCommandHandler:f}=re();return{add:async a=>{await d.handle({carrierId:a.ownerId,street:a.street,city:a.city,zip:a.zip,country:a.country,name:a.name,isPrimary:a.isPrimary})},edit:async a=>{await f.handle({carrierId:a.ownerId,addressId:a.addressId,street:a.street,city:a.city,zip:a.zip,country:a.country,name:a.name,isPrimary:a.isPrimary})}}}throw new Error(`Unknown owner type: ${o}`)}const oe=N({__name:"AddressModal",props:{ownerId:{type:String,required:!0},ownerType:{type:String,required:!0},address:{type:ve,required:!1,default:null},mini:{type:Boolean,required:!1,default:!1}},setup(o){const{maxLength:d,required:f}=ie(),{tCap:a}=ne(),s=o,{form:r}=Ce(),n=E(()=>!!s.address),w=E(()=>n.value?a("address.editAddress"):a("address.addAddress")),h=E(()=>n.value?"mdi-pencil":"mdi-plus"),{dialog:y,formRef:I,validForm:H,loading:g,errorMessage:x,close:q,submit:U}=de(r);se(y,_=>{_&&s.address&&(r.street=s.address.street,r.city=s.address.city,r.zip=s.address.zip,r.country=s.address.country,r.name=s.address.name??"",r.isPrimary=s.address.isPrimary)});const{add:$,edit:c}=be(s.ownerType);async function J(){await U(async _=>{s.address?await c({ownerId:s.ownerId,addressId:s.address.id,street:_.street,city:_.city,zip:_.zip,country:_.country,name:_.name,isPrimary:_.isPrimary}):await $({ownerId:s.ownerId,street:_.street,city:_.city,zip:_.zip,country:_.country,name:_.name,isPrimary:_.isPrimary})})}return(_,v)=>{const M=i("v-btn"),T=i("v-text-field"),p=i("v-col"),C=i("v-switch"),B=i("v-row"),R=i("v-alert"),L=i("v-container"),K=i("v-form"),O=i("v-card-text"),G=i("v-spacer"),Q=i("v-card-actions"),W=i("v-card"),X=i("v-dialog");return u(),z(X,{modelValue:e(y),"onUpdate:modelValue":v[7]||(v[7]=m=>j(y)?y.value=m:null),"max-width":"500"},{activator:l(({props:m})=>[o.mini?A("",!0):(u(),z(M,D({key:0},m,{color:n.value?"indigo":"success",text:w.value,"prepend-icon":h.value,variant:"flat"}),null,16,["color","text","prepend-icon"])),o.mini?(u(),z(M,D({key:1},m,{color:n.value?"indigo":"success",icon:h.value,variant:"text",density:"compact"}),null,16,["color","icon"])):A("",!0)]),default:l(()=>[t(W,{title:w.value},{default:l(()=>[t(O,null,{default:l(()=>[t(K,{ref_key:"formRef",ref:I,modelValue:e(H),"onUpdate:modelValue":v[6]||(v[6]=m=>j(H)?H.value=m:null)},{default:l(()=>[t(L,{class:"pa-0",fluid:""},{default:l(()=>[t(B,{dense:""},{default:l(()=>[t(p,{cols:"12"},{default:l(()=>[t(T,{modelValue:e(r).street,"onUpdate:modelValue":v[0]||(v[0]=m=>e(r).street=m),label:e(a)("address.street"),rules:[e(f),e(d)(50)]},null,8,["modelValue","label","rules"])]),_:1}),t(p,{cols:"8"},{default:l(()=>[t(T,{modelValue:e(r).city,"onUpdate:modelValue":v[1]||(v[1]=m=>e(r).city=m),label:e(a)("address.city"),rules:[e(f),e(d)(50)]},null,8,["modelValue","label","rules"])]),_:1}),t(p,{cols:"4"},{default:l(()=>[t(T,{modelValue:e(r).zip,"onUpdate:modelValue":v[2]||(v[2]=m=>e(r).zip=m),label:e(a)("address.zip"),rules:[e(d)(50)]},null,8,["modelValue","label","rules"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(T,{modelValue:e(r).country,"onUpdate:modelValue":v[3]||(v[3]=m=>e(r).country=m),label:e(a)("address.country"),rules:[e(d)(50)]},null,8,["modelValue","label","rules"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(T,{modelValue:e(r).name,"onUpdate:modelValue":v[4]||(v[4]=m=>e(r).name=m),label:e(a)("common.name"),rules:[e(d)(50)]},null,8,["modelValue","label","rules"])]),_:1}),t(p,{cols:"12"},{default:l(()=>[t(C,{modelValue:e(r).isPrimary,"onUpdate:modelValue":v[5]||(v[5]=m=>e(r).isPrimary=m),label:e(a)("common.primary_gen")},null,8,["modelValue","label"])]),_:1})]),_:1}),e(x)?(u(),z(R,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-2"},{default:l(()=>[te(k(e(x)),1)]),_:1})):A("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(Q,null,{default:l(()=>[t(G),t(M,{variant:"tonal",color:"indigo",text:e(a)("common.save"),loading:e(g),disabled:!e(H)||e(g),onClick:J},null,8,["text","loading","disabled"]),t(M,{text:e(a)("common.cancel"),color:"red",disabled:e(g),onClick:e(q)},null,8,["text","disabled","onClick"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}});function xe(o,d){if(o==="partner"){const{addEmailCommandHandler:f,addPhoneCommandHandler:a,editEmailCommandHandler:s,editPhoneCommandHandler:r}=ae();if(d===P.Email)return{add:async n=>{await f.handle({partnerId:n.ownerId,email:n.value,name:n.name,isPrimary:n.isPrimary})},edit:async n=>{await s.handle({partnerId:n.ownerId,emailId:n.contactId,email:n.value,name:n.name,isPrimary:n.isPrimary})}};if(d===P.Phone)return{add:async n=>{await a.handle({partnerId:n.ownerId,phone:n.value,name:n.name,isPrimary:n.isPrimary})},edit:async n=>{await r.handle({partnerId:n.ownerId,phoneId:n.contactId,phone:n.value,name:n.name,isPrimary:n.isPrimary})}}}if(o==="deliveryCarrier"){const{addEmailCommandHandler:f,addPhoneCommandHandler:a,editEmailCommandHandler:s,editPhoneCommandHandler:r}=re();if(d===P.Email)return{add:async n=>{await f.handle({carrierId:n.ownerId,email:n.value,name:n.name,isPrimary:n.isPrimary})},edit:async n=>{await s.handle({carrierId:n.ownerId,emailId:n.contactId,email:n.value,name:n.name,isPrimary:n.isPrimary})}};if(d===P.Phone)return{add:async n=>{await a.handle({carrierId:n.ownerId,phone:n.value,name:n.name,isPrimary:n.isPrimary})},edit:async n=>{await r.handle({carrierId:n.ownerId,phoneId:n.contactId,phone:n.value,name:n.name,isPrimary:n.isPrimary})}}}throw new Error(`Unsupported ownerType (${o}) or contactType (${d})`)}const S=N({__name:"ContactModal",props:{ownerId:{type:String,required:!0},contactType:{type:String,required:!0,validator:o=>Object.values(P).includes(o)},ownerType:{type:String,required:!0},contact:{type:fe,required:!1,default:null},mini:{type:Boolean,required:!1,default:!1}},setup(o){const{maxLength:d,required:f,emailFormat:a,phoneFormat:s}=ie(),{tCap:r}=ne(),n=o,{form:w}=Pe(n.contactType),h=E(()=>!!n.contact),y=E(()=>{switch(n.contactType){case P.Email:return a;case P.Phone:return s;default:return f}}),I=E(()=>n.contactType===P.Phone?r("contact.phone"):r("contact.email")),H=E(()=>n.contactType===P.Email?h.value?r("contact.editEmail"):r("contact.addEmail"):h.value?r("contact.editPhone"):r("contact.addPhone")),g=E(()=>h.value?"mdi-pencil":"mdi-plus"),{dialog:x,formRef:q,validForm:U,loading:$,errorMessage:c,close:J,submit:_}=de(w);se(x,p=>{p&&n.contact&&(w.value=n.contact.value,w.name=n.contact.name??"",w.isPrimary=n.contact.isPrimary)});const{add:v,edit:M}=xe(n.ownerType,n.contactType);async function T(){await _(async p=>{n.contact?await M({ownerId:n.ownerId,contactId:n.contact.id,value:p.value,name:p.name,isPrimary:p.isPrimary}):await v({ownerId:n.ownerId,value:p.value,name:p.name,isPrimary:p.isPrimary})})}return(p,C)=>{const B=i("v-btn"),R=i("v-text-field"),L=i("v-col"),K=i("v-switch"),O=i("v-row"),G=i("v-alert"),Q=i("v-container"),W=i("v-form"),X=i("v-card-text"),m=i("v-spacer"),ce=i("v-card-actions"),me=i("v-card"),ue=i("v-dialog");return u(),z(ue,{modelValue:e(x),"onUpdate:modelValue":C[4]||(C[4]=b=>j(x)?x.value=b:null),"max-width":"500"},{activator:l(({props:b})=>[o.mini?A("",!0):(u(),z(B,D({key:0},b,{color:h.value?"indigo":"success",text:H.value,"prepend-icon":g.value,variant:"flat"}),null,16,["color","text","prepend-icon"])),o.mini?(u(),z(B,D({key:1},b,{color:h.value?"indigo":"success",icon:g.value,variant:"text",density:"compact"}),null,16,["color","icon"])):A("",!0)]),default:l(()=>[t(me,{title:H.value},{default:l(()=>[t(X,null,{default:l(()=>[t(W,{ref_key:"formRef",ref:q,modelValue:e(U),"onUpdate:modelValue":C[3]||(C[3]=b=>j(U)?U.value=b:null)},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,null,{default:l(()=>[t(L,{cols:"12"},{default:l(()=>[t(R,{modelValue:e(w).value,"onUpdate:modelValue":C[0]||(C[0]=b=>e(w).value=b),label:I.value,type:"email",rules:[y.value]},null,8,["modelValue","label","rules"])]),_:1}),t(L,{cols:"12"},{default:l(()=>[t(R,{modelValue:e(w).name,"onUpdate:modelValue":C[1]||(C[1]=b=>e(w).name=b),label:e(r)("common.name"),rules:[e(d)(50)]},null,8,["modelValue","label","rules"])]),_:1}),t(L,{cols:"12"},{default:l(()=>[t(K,{modelValue:e(w).isPrimary,"onUpdate:modelValue":C[2]||(C[2]=b=>e(w).isPrimary=b),label:e(r)("common.primary_gen")},null,8,["modelValue","label"])]),_:1})]),_:1}),e(c)?(u(),z(G,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-2"},{default:l(()=>[te(k(e(c)),1)]),_:1})):A("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(ce,null,{default:l(()=>[t(m),t(B,{variant:"tonal",color:"indigo",text:e(r)("common.save"),loading:e($),disabled:!e(U)||e($),onClick:T},null,8,["text","loading","disabled"]),t(B,{text:e(r)("common.cancel"),color:"red",disabled:e($),onClick:e(J)},null,8,["text","disabled","onClick"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),he=["href"],ge=N({__name:"EmailLink",props:{email:{}},setup(o){const d=o;return(f,a)=>{const s=i("v-icon");return u(),V("div",null,[t(s,{icon:"mdi-email",size:"16",class:"mr-1 text-grey"}),F("a",{href:`mailto:${d.email.value}`,class:"text-decoration-none text-body-2",onClic:a[0]||(a[0]=_e(()=>{},["stop"]))},k(d.email.value),41,he)])}}}),Ve={class:"text-subtitle-2 mb-2"},ke={key:0,class:"text-grey text-body-2 mb-2"},He={class:"d-flex align-center"},Ee={class:"text-subtitle-2 mb-2"},ze={key:0,class:"text-grey text-body-2 mb-2"},Ae={class:"d-flex align-center"},Ue={class:"text-subtitle-2 mb-2"},qe={key:0,class:"text-grey text-body-2 mb-2"},$e={class:"d-flex align-center"},Le=N({__name:"ContactInfo",props:{contactInfo:{}},setup(o){const{tCap:d}=ne(),f=ae(),a=re(),s=o,r=E(()=>{if(s.contactInfo instanceof ye)return"partner";if(s.contactInfo instanceof pe)return"deliveryCarrier";throw new Error("ContactInfo is not of type Partner or DeliveryCarrier")});function n(y,I){r.value==="partner"?f.removeEmailCommandHandler.handle({partnerId:y,emailId:I}):r.value==="deliveryCarrier"&&a.removeEmailCommandHandler.handle({carrierId:y,emailId:I})}function w(y,I){r.value==="partner"?f.removePhoneCommandHandler.handle({partnerId:y,phoneId:I}):r.value==="deliveryCarrier"&&a.removePhoneCommandHandler.handle({carrierId:y,phoneId:I})}function h(y,I){r.value==="partner"?f.removeAddressCommandHandler.handle({partnerId:y,addressId:I}):r.value==="deliveryCarrier"&&a.removeAddressCommandHandler.handle({carrierId:y,addressId:I})}return(y,I)=>{const H=i("v-card-title"),g=i("v-divider"),x=i("v-col"),q=i("v-row"),U=i("v-card-text"),$=i("v-card");return u(),z($,null,{default:l(()=>[t(H,null,{default:l(()=>[te(k(e(d)("contact.contactInfo")),1)]),_:1}),t(g),t(U,null,{default:l(()=>[t(q,null,{default:l(()=>[t(x,null,{default:l(()=>[F("h3",Ve,k(e(d)("contact.email",2)),1),o.contactInfo.emails.length===0?(u(),V("div",ke,k(e(d)("contact.noEmails")),1)):A("",!0),(u(!0),V(Z,null,Y(o.contactInfo.emails,c=>(u(),V("div",{key:c.id,class:"d-flex align-center justify-space-between mb-2"},[t(ge,{email:c},null,8,["email"]),F("div",He,[t(S,{"owner-id":o.contactInfo.id,contact:c,"owner-type":r.value,"contact-type":e(P).Email,mini:""},null,8,["owner-id","contact","owner-type","contact-type"]),t(ee,{name:c.value,"action-fn":()=>n(o.contactInfo.id,c.id),mini:""},null,8,["name","action-fn"])])]))),128)),t(S,{"owner-id":o.contactInfo.id,"owner-type":r.value,"contact-type":e(P).Email},null,8,["owner-id","owner-type","contact-type"])]),_:1})]),_:1}),t(g,{class:"my-4"}),t(q,null,{default:l(()=>[t(x,null,{default:l(()=>[F("h3",Ee,k(e(d)("contact.phone",2)),1),o.contactInfo.phones.length===0?(u(),V("div",ze,k(e(d)("contact.noPhones")),1)):A("",!0),(u(!0),V(Z,null,Y(o.contactInfo.phones,c=>(u(),V("div",{key:c.id,class:"d-flex align-center justify-space-between mb-2"},[t(we,{phone:c},null,8,["phone"]),F("div",Ae,[t(S,{"owner-id":o.contactInfo.id,contact:c,"owner-type":r.value,"contact-type":e(P).Phone,mini:""},null,8,["owner-id","contact","owner-type","contact-type"]),t(ee,{name:c.value,"action-fn":()=>w(o.contactInfo.id,c.id),mini:""},null,8,["name","action-fn"])])]))),128)),t(S,{"owner-id":o.contactInfo.id,"owner-type":r.value,"contact-type":e(P).Phone},null,8,["owner-id","owner-type","contact-type"])]),_:1})]),_:1}),t(g,{class:"my-4"}),t(q,null,{default:l(()=>[t(x,null,{default:l(()=>[F("h3",Ue,k(e(d)("address.address",2)),1),o.contactInfo.addresses.length===0?(u(),V("div",qe,k(e(d)("contact.noAddresses")),1)):A("",!0),(u(!0),V(Z,null,Y(o.contactInfo.addresses,c=>(u(),V("div",{key:c.id,class:"d-flex align-center justify-space-between mb-2"},[t(Ie,{address:c,format:"full"},null,8,["address"]),F("div",$e,[t(oe,{"owner-id":o.contactInfo.id,address:c,"owner-type":r.value,mini:""},null,8,["owner-id","address","owner-type"]),t(ee,{name:c.value,"action-fn":()=>h(o.contactInfo.id,c.id),mini:""},null,8,["name","action-fn"])])]))),128)),t(oe,{"owner-id":o.contactInfo.id,"owner-type":r.value},null,8,["owner-id","owner-type"])]),_:1})]),_:1})]),_:1})]),_:1})}}});export{Le as _};
