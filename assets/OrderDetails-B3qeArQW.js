import{_ as M}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-DBflF40U.js";import{u as H,a as q,_ as F,h as z,j as k,d as E,B as P,e as Q,s as j,f as N,k as J}from"./useVariationTableMapper-BwvUWhRO.js";import{d as V,g as C,C as w,c as D,e as a,l,q as t,B as r,z as o,x as p,y as f,u as s,a9 as I,J as R,F as K,o as c,_ as U,m as x,a7 as G,r as W,I as X}from"./index-DLPsEI6P.js";import{g as Y}from"./usePartnerDetails-DVJLeuBh.js";const Z={class:"mr-2"},ee={key:0,class:"text-subtitle-1 text-grey-darken-1 order-details-line"},te={key:0},oe={key:1},ne={key:1,class:"text-subtitle-1 text-grey-darken-1 order-details-line"},se={class:"text-subtitle-1 text-grey-darken-1 font-weight-bold order-details-line"},ae={class:"formatted-notes"},re={class:"text-h5 font-weight-bold"},le={key:0},ie={key:0},de=V({__name:"OrderDetailsHeader",props:{order:{}},setup(e){const{tCap:n}=C(),i=K(),{deleteOrderCommmandHandler:g}=H(),d=e,_=w(()=>Y(d.order.partnerId));function u(){return`#${d.order.orderNumber}`}function h(){i.back(),g.handle({id:d.order.id})}return($,y)=>{const v=l("v-col"),m=l("v-row"),b=l("v-btn");return c(),D(R,null,[a(m,{align:"start",justify:"space-between",dense:""},{default:t(()=>[a(v,{cols:"5",class:"d-flex",justify:"start"},{default:t(()=>[r("h1",Z,o(u()),1),a(q,{status:e.order.status,class:"ml-2 mt-2"},null,8,["status"]),a(F,{direction:e.order.direction,class:"ml-2 mt-2"},null,8,["direction"])]),_:1}),a(v,{cols:"4",class:"d-flex flex-row justify-end"}),a(v,{cols:"1",class:"d-flex flex-row justify-end"},{default:t(()=>[a(M,{name:u(),"action-fn":()=>h(),mini:""},null,8,["name","action-fn"])]),_:1})]),_:1}),a(m,{align:"start",justify:"space-between",dense:""},{default:t(()=>[a(v,{cols:"3",class:"text-md-left"},{default:t(()=>[_.value?(c(),D("div",ee,[e.order.direction===s(I).Credit?(c(),D("strong",te,o(s(n)("partner.customer")),1)):p("",!0),e.order.direction===s(I).Debit?(c(),D("strong",oe,o(s(n)("partner.customer")),1)):p("",!0),y[0]||(y[0]=f(": ",-1)),a(b,{variant:"text",to:`/partner/${_.value.id}`},{default:t(()=>[f(o(_.value.businessName),1)]),_:1},8,["to"])])):p("",!0),e.order.dueDate?(c(),D("div",ne,[r("strong",null,o(s(n)("order.dueDate")),1),f(": "+o(s(z)(e.order.dueDate)),1)])):p("",!0),r("div",se,o(s(n)("order.notes"))+": ",1),r("span",ae,o(e.order.notes),1)]),_:1}),a(v,{cols:"4",md:"5",class:"text-md-right"},{default:t(()=>[r("span",null,o(s(n)("order.total")),1),r("div",re,o(s(k)(e.order.totalAmount)),1),r("div",null,[f(o(s(n)("order.orderSum"))+" ",1),r("strong",null,o(s(k)(e.order.subtotal)),1),f(" · "+o(s(n)("order.vatRate"))+" ",1),r("strong",null,o(s(k)(e.order.taxAmount)),1),e.order.discountAmount>0?(c(),D("span",le,[f(" · "+o(s(n)("order.discount"))+" ",1),r("strong",null,o(s(k)(e.order.discountAmount)),1)])):p("",!0)]),e.order.depositAmount>0?(c(),D("div",ie,[f(o(s(n)("order.deposit"))+" ",1),r("strong",null,o(s(k)(e.order.discountAmount)),1),f(" · "+o(s(n)("order.remainingAmount"))+" ",1),r("strong",null,o(s(k)(e.order.remainingAmount)),1)])):p("",!0)]),_:1})]),_:1})],64)}}}),ce=U(de,[["__scopeId","data-v-92f99827"]]),ue=V({__name:"DisplayTable",props:{tableRows:{},tableColumns:{},hideRowIndex:{type:Boolean}},setup(e){const n=e,i=w(()=>E(n.tableRows));return(g,d)=>(c(),x(P,{modelValue:i.value,"table-columns":e.tableColumns,"hide-row-index":e.hideRowIndex},null,8,["modelValue","table-columns","hide-row-index"]))}});function me(e){return{id:e.id,name:e.name,variations:_e([...e.variations])}}function _e(e){const n=e.map(fe);return ve(n)}function ve(e){const n=new Map;for(const i of e){const g=i.normalizedAttributes,d=n.get(g);if(d)for(const[_,u]of Object.entries(i.sizing))d.sizing[_]=(d.sizing[_]||0)+u;else n.set(g,{...i,sizing:{...i.sizing}})}return[...n.values()]}function fe(e){const{size:n,...i}=e.attributes;return{attributes:pe(i),sizing:ge(n,e.quantity),price:e.price,normalizedAttributes:G(i)}}function pe(e){return Object.fromEntries(Object.entries(e).map(([n,i])=>[n,i.toString()]))}function ge(e,n){return{[`shoe:${e}`]:n}}const xe=V({__name:"OrderDetailsLineItemDetails",props:{item:{}},setup(e){const{tCap:n}=C(),{regVmToRows:i}=Q(N),g=e,d=w(()=>me(g.item)),_=w(()=>i(d.value.variations)),u=w(()=>{const v=d.value.variations.reduce((m,b)=>{const O=Object.values(b.attributes).filter(A=>A).join(" ");return m?m+", "+O:O},"");return v?`(${v})`:""}),h=w(()=>d.value.variations.length),$=w(()=>d.value.variations.reduce((v,m)=>v+j(m),0)),y=w(()=>d.value.variations.reduce((v,m)=>v+j(m)*m.price,0));return(v,m)=>{const b=l("v-col"),O=l("v-spacer"),A=l("v-row"),T=l("v-fade-transition"),B=l("v-expansion-panel-title"),L=l("v-expansion-panel-text"),S=l("v-expansion-panel");return c(),x(S,null,{default:t(()=>[a(B,{"hide-actions":""},{default:t(({expanded:je})=>[a(A,{"no-gutters":""},{default:t(()=>[a(b,{class:"d-flex justify-start",cols:"4"},{default:t(()=>[f(o(d.value.name||"no name")+" "+o(u.value),1)]),_:1}),a(b,{class:"text--secondary",cols:"8"},{default:t(()=>[a(T,{"leave-absolute":""},{default:t(()=>[a(A,{style:{width:"100%"},"no-gutters":""},{default:t(()=>[a(O),a(b,{cols:"3"},{default:t(()=>[f(o(s(n)("order.variation",2))+": ",1),r("strong",null,o(h.value),1)]),_:1}),a(b,{cols:"3"},{default:t(()=>[f(o(s(n)("order.productQuantity"))+": ",1),r("strong",null,o($.value),1)]),_:1}),a(b,{cols:"3"},{default:t(()=>[f(o(s(n)("order.productSum"))+": ",1),r("strong",null,o(y.value.toFixed(2))+"€",1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(L,null,{default:t(()=>[a(ue,{tableRows:_.value,"table-columns":s(N)},null,8,["tableRows","table-columns"])]),_:1})]),_:1})}}}),he=V({__name:"OrderDetailsLineItems",props:{order:{}},setup(e){const{tCap:n}=C(),i=W([]);return(g,d)=>{const _=l("v-chip"),u=l("v-list-item"),h=l("v-card-title"),$=l("v-expansion-panels"),y=l("v-card-text"),v=l("v-card");return c(),x(v,null,{default:t(()=>[a(h,null,{default:t(()=>[a(u,null,{title:t(()=>[r("h3",null,o(s(n)("order.items",2)),1)]),append:t(()=>[a(_,{size:"small"},{default:t(()=>[f(o(e.order.items.length),1)]),_:1})]),_:1})]),_:1}),a(y,null,{default:t(()=>[a($,{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=m=>i.value=m),multiple:""},{default:t(()=>[(c(!0),D(R,null,X(e.order.items,m=>(c(),x(xe,{key:m.id,item:m},null,8,["item"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),be={class:"d-flex"},ye={class:"me-4"},De={class:"d-flex"},we={class:"me-4"},$e={class:"d-flex"},ke={class:"me-4"},ze={class:"d-flex"},Ve={class:"me-4"},Oe={class:"d-flex"},Ae={class:"me-4"},Ce=V({__name:"OrderDetailsTimeline",props:{order:{}},setup(e){const{tCap:n}=C();return(i,g)=>{const d=l("v-card-title"),_=l("v-divider"),u=l("v-timeline-item"),h=l("v-timeline"),$=l("v-card-text"),y=l("v-card");return c(),x(y,null,{default:t(()=>[a(d,null,{default:t(()=>[f(o(s(n)("common.timeline")),1)]),_:1}),a(_),a($,null,{default:t(()=>[a(h,{align:"start",side:"end"},{default:t(()=>[a(u,{"dot-color":"indigo",size:"small"},{opposite:t(()=>[r("div",null,o(s(n)("order.createdDate")),1)]),default:t(()=>[r("div",be,[r("strong",ye,o(s(z)(e.order.createdDate)),1)])]),_:1}),e.order.approvedDate?(c(),x(u,{key:0,"dot-color":"indigo",size:"small"},{opposite:t(()=>[r("div",null,o(s(n)("order.approvedDate")),1)]),default:t(()=>[r("div",De,[r("strong",we,o(s(z)(e.order.approvedDate)),1)])]),_:1})):p("",!0),e.order.shippedDate?(c(),x(u,{key:1,"dot-color":"indigo",size:"small"},{opposite:t(()=>[r("div",null,o(s(n)("order.shippedDate")),1)]),default:t(()=>[r("div",$e,[r("strong",ke,o(s(z)(e.order.shippedDate)),1)])]),_:1})):p("",!0),e.order.completedDate?(c(),x(u,{key:2,"dot-color":"grey",size:"small"},{opposite:t(()=>[r("div",null,o(s(n)("order.completedDate")),1)]),default:t(()=>[r("div",ze,[r("strong",Ve,o(s(z)(e.order.completedDate)),1)])]),_:1})):p("",!0),e.order.cancelledDate?(c(),x(u,{key:3,"dot-color":"red",size:"small"},{opposite:t(()=>[r("div",null,o(s(n)("order.cancelledDate")),1)]),default:t(()=>[r("div",Oe,[r("strong",Ae,o(s(z)(e.order.cancelledDate)),1)])]),_:1})):p("",!0)]),_:1})]),_:1})]),_:1})}}}),Be=V({__name:"OrderDetails",props:{id:{}},setup(e){const n=e,{model:i}=J(n.id);return(g,d)=>{const _=l("v-col"),u=l("v-row"),h=l("v-container");return s(i)?(c(),x(h,{key:0},{default:t(()=>[a(ce,{order:s(i)},null,8,["order"]),a(u,{class:"mt-6",align:"start"},{default:t(()=>[a(_,{cols:"12",md:"8",xl:"10"},{default:t(()=>[a(he,{order:s(i)},null,8,["order"])]),_:1}),a(_,{cols:"12",md:"4",xl:"2"},{default:t(()=>[a(Ce,{order:s(i)},null,8,["order"])]),_:1})]),_:1})]),_:1})):p("",!0)}}});export{Be as default};
