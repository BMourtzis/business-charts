import{_ as V}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-HfGbeW7V.js";import{u as R,a as B,_ as j,h as $,j as D,d as E,B as M,e as P,s as I,k as H}from"./useVariationTableMapper-CQ4d39Vh.js";import{d as C,g as z,C as S,c as x,e as n,l as c,q as s,B as i,z as o,x as y,y as v,u as a,J as A,F as q,o as f,_ as F,m as k,a7 as K,a9 as T,I as J}from"./index-Bf_LNgB1.js";import{g as U}from"./usePartnerDetails-CpoMd4NZ.js";const G={class:"mr-2"},Q={key:0,class:"text-subtitle-1 text-grey-darken-1 order-details-line"},W={key:1,class:"text-subtitle-1 text-grey-darken-1 order-details-line"},X={class:"text-subtitle-1 text-grey-darken-1 font-weight-bold order-details-line"},Y={class:"formatted-notes"},Z={class:"text-h5 font-weight-bold"},ee={key:0},te={key:0},ne=C({__name:"OrderDetailsHeader",props:{order:{}},setup(e){const{tCap:t}=z(),l=q(),{deleteOrderCommmandHandler:m}=R(),_=e,u=S(()=>U(_.order.partnerId));function g(){return`#${_.order.orderNumber}`}function r(){l.back(),m.handle({id:_.order.id})}return(b,h)=>{const p=c("v-col"),d=c("v-row"),w=c("v-btn");return f(),x(A,null,[n(d,{align:"start",justify:"space-between",dense:""},{default:s(()=>[n(p,{cols:"5",class:"d-flex",justify:"start"},{default:s(()=>[i("h1",G,o(g()),1),n(B,{status:e.order.status,class:"ml-2 mt-2"},null,8,["status"]),n(j,{type:e.order.type,class:"ml-2 mt-2"},null,8,["type"])]),_:1}),n(p,{cols:"4",class:"d-flex flex-row justify-end"}),n(p,{cols:"1",class:"d-flex flex-row justify-end"},{default:s(()=>[n(V,{name:g(),"action-fn":()=>r(),mini:""},null,8,["name","action-fn"])]),_:1})]),_:1}),n(d,{align:"start",justify:"space-between",dense:""},{default:s(()=>[n(p,{cols:"3",class:"text-md-left"},{default:s(()=>[u.value?(f(),x("div",Q,[i("strong",null,o(a(t)("partner.customer")),1),h[0]||(h[0]=v(": ",-1)),n(w,{variant:"text",to:`/partner/${u.value.id}`},{default:s(()=>[v(o(u.value.businessName),1)]),_:1},8,["to"])])):y("",!0),e.order.dueDate?(f(),x("div",W,[i("strong",null,o(a(t)("order.dueDate")),1),v(": "+o(a($)(e.order.dueDate)),1)])):y("",!0),i("div",X,o(a(t)("order.notes"))+": ",1),i("span",Y,o(e.order.notes),1)]),_:1}),n(p,{cols:"4",md:"5",class:"text-md-right"},{default:s(()=>[i("span",null,o(a(t)("order.total")),1),i("div",Z,o(a(D)(e.order.totalAmount)),1),i("div",null,[v(o(a(t)("order.orderSum"))+" ",1),i("strong",null,o(a(D)(e.order.subtotal)),1),v(" · "+o(a(t)("order.vatRate"))+" ",1),i("strong",null,o(a(D)(e.order.taxAmount)),1),e.order.discountAmount>0?(f(),x("span",ee,[v(" · "+o(a(t)("order.discount"))+" ",1),i("strong",null,o(a(D)(e.order.discountAmount)),1)])):y("",!0)]),e.order.depositAmount>0?(f(),x("div",te,[v(o(a(t)("order.deposit"))+" ",1),i("strong",null,o(a(D)(e.order.discountAmount)),1),v(" · "+o(a(t)("order.remainingAmount"))+" ",1),i("strong",null,o(a(D)(e.order.remainingAmount)),1)])):y("",!0)]),_:1})]),_:1})],64)}}}),oe=F(ne,[["__scopeId","data-v-ae8f03bf"]]),ae=C({__name:"DisplayTable",props:{tableRows:{},tableColumns:{},hideRowIndex:{type:Boolean}},setup(e){const t=e,l=S(()=>E(t.tableRows));return(m,_)=>(f(),k(M,{modelValue:l.value,"table-columns":e.tableColumns,"hide-row-index":e.hideRowIndex},null,8,["modelValue","table-columns","hide-row-index"]))}});function se(e){const t=e.map(re);return le(t)}function re(e){const t=e.sku.variationSnapshot.attributes??{},{size:l,...m}=t;return{name:e.name,unitPrice:e.unitPrice,productCode:e.productCode,derivedSku:K(e.productCode,{attributes:m,flags:e.sku.variationSnapshot.flags}),variationSnapshot:{attributes:m,flags:e.sku.variationSnapshot.flags},sizing:de(l,e.quantity)}}function le(e){const t=new Map;for(const l of e){const m=l.derivedSku,_=t.get(m);if(_)for(const[u,g]of Object.entries(l.sizing))_.sizing[u]=(_.sizing[u]||0)+g;else t.set(m,{...l,sizing:{...l.sizing}})}return[...t.values()]}function de(e,t){return{[`shoe:${e}`]:t}}const ce=C({__name:"OrderDetailsLineItems",props:{order:{}},setup(e){const{tCap:t}=z(),{vmToRows:l}=P(I),m=e,_=S(()=>{const u=se([...m.order.items]);return l(u)});return(u,g)=>{const r=c("v-chip"),b=c("v-list-item"),h=c("v-card-title"),p=c("v-card-text"),d=c("v-card");return f(),k(d,null,{default:s(()=>[n(h,null,{default:s(()=>[n(b,null,{title:s(()=>[i("h3",null,o(a(t)("order.items",2)),1)]),append:s(()=>[n(r,{size:"small"},{default:s(()=>[v(o(e.order.items.length),1)]),_:1})]),_:1})]),_:1}),n(p,null,{default:s(()=>[n(ae,{tableRows:_.value,"table-columns":a(I)},null,8,["tableRows","table-columns"])]),_:1})]),_:1})}}}),ie={class:"d-flex"},ue={key:0,class:"me-4"},me=C({__name:"OrderDetailsTimeline",props:{order:{}},setup(e){const{tCap:t}=z(),l=e,m=S(()=>g(l.order)),_=[{name:t("order.createdDate"),getDate:r=>r.createdDate},{name:t("order.approvedDate"),getDate:r=>r.approvedDate},{name:t("order.shippedDate"),getDate:r=>r.shippedDate},{name:t("order.completedDate"),getDate:r=>r.completedDate}],u={name:t("order.cancelledDate"),getDate:r=>r.cancelledDate,isCancelled:!0};function g(r){const b=[..._];r.status===T.Cancelled&&b.push(u);const h=b.map(d=>({name:d.name,date:d.getDate(r)})),p=h.map(d=>d.date).findLastIndex(d=>d!==void 0);return h.map((d,w)=>r.status===T.Cancelled&&d.name==="Cancelled"?{...d,colour:"red"}:d.date?{...d,colour:w===p?"indigo":"cyan"}:{...d,colour:"grey"})}return(r,b)=>{const h=c("v-card-title"),p=c("v-divider"),d=c("v-timeline-item"),w=c("v-timeline"),L=c("v-card-text"),N=c("v-card");return f(),k(N,null,{default:s(()=>[n(h,null,{default:s(()=>[v(o(a(t)("common.timeline")),1)]),_:1}),n(p),n(L,null,{default:s(()=>[n(w,{align:"start",side:"end",direction:"horizontal"},{default:s(()=>[(f(!0),x(A,null,J(m.value,O=>(f(),k(d,{"dot-color":O.colour,size:"small"},{opposite:s(()=>[i("div",null,o(O.name),1)]),default:s(()=>[i("div",ie,[O.date?(f(),x("strong",ue,o(a($)(O.date)),1)):y("",!0)])]),_:2},1032,["dot-color"]))),256))]),_:1})]),_:1})]),_:1})}}}),ge=C({__name:"OrderDetails",props:{id:{}},setup(e){const t=e,{model:l}=H(t.id);return(m,_)=>{const u=c("v-col"),g=c("v-row"),r=c("v-container");return a(l)?(f(),k(r,{key:0},{default:s(()=>[n(oe,{order:a(l)},null,8,["order"]),n(g,{class:"mt-6",align:"start"},{default:s(()=>[n(u,{cols:"12"},{default:s(()=>[n(ce,{order:a(l)},null,8,["order"])]),_:1}),n(u,{cols:"12",md:"12",xl:"12"},{default:s(()=>[n(me,{order:a(l)},null,8,["order"])]),_:1})]),_:1})]),_:1})):y("",!0)}}});export{ge as default};
