import{O as u,U as o,Q as y,V as E,W as ae,X as U,Y as q,Z as te,C as b,d as A,N as ne,f as oe,g as ie,j as se,k as de,w as le,m as k,l as c,u as n,p as O,q as l,e as i,x as C,c as f,I as ce,y as ue,z as I,A as R,o as p,B as M,J as L}from"./index-CeMrVeL6.js";class me{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=E(e.street,e.city,e.zip,e.country,e.isPrimary,e.name);return r.addAddress(t),await o.update(r),this._carrierStore.update(y.toDTO(r)),r}}class ye{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=E(e.street,e.city,e.zip,e.country,e.isPrimary,e.name);return r.editAddress(e.addressId,t),await o.update(r),this._carrierStore.update(y.toDTO(r)),r}}class pe{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(r)return r.removeAddress(e.addressId),await o.update(r),this._carrierStore.update(y.toDTO(r)),r}}class ve{constructor(e=u()){this._deliveryCarrierStore=e}async handle(e){const r=E(e.address.street,e.address.city,e.address.zip,e.address.country,e.address.isPrimary,e.address.name),t=ae(e.name,r);return await o.add(t),this._deliveryCarrierStore.add(y.toDTO(t)),t}}class _e{constructor(e=u()){this._deliveryCarrierStore=e}async handle(e){await o.remove(e.id),this._deliveryCarrierStore.remove(e.id)}}class Ce{constructor(e=u()){this._deliveryCarrierStore=e}async handle(e){const r=await o.getById(e.id);if(r)return r.name=e.name,await o.update(r),this._deliveryCarrierStore.update(y.toDTO(r)),r}}class fe{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=U(e.email,e.isPrimary,e.name);return r.addEmail(t),await o.update(r),this._carrierStore.update(y.toDTO(r)),r}}class he{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=U(e.email,e.isPrimary,e.name);return r.editEmail(e.emailId,t),await o.update(r),this._carrierStore.update(y.toDTO(r)),r}}class we{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(r)return r.removeEmail(e.emailId),await o.update(r),this._carrierStore.update(y.toDTO(r)),r}}class ge{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=q(e.phone,e.isPrimary,e.name);return r.addPhone(t),await o.update(r),this._carrierStore.update(y.toDTO(r)),r}}class Ie{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=q(e.phone,e.isPrimary,e.name);return r.editPhone(e.phoneId,t),await o.update(r),this._carrierStore.update(y.toDTO(r)),r}}class De{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(r)return r.removePhone(e.phoneId),await o.update(r),this._carrierStore.update(y.toDTO(r)),r}}function He(){const a=u(),{all:e}=te(a);return{carriers:b(()=>e.value.map(y.toModel)),createDeliveryCarrierCommandHandler:new ve(a),editDeliveryCarrierCommandHandler:new Ce(a),deleteDeliveryCarrierCommandHandler:new _e(a),addEmailCommandHandler:new fe(a),editEmailCommandHandler:new he(a),removeEmailCommandHandler:new we(a),addPhoneCommandHandler:new ge(a),editPhoneCommandHandler:new Ie(a),removePhoneCommandHandler:new De(a),addAddressCommandHandler:new me(a),editAddressCommandHandler:new ye(a),removeAddressCommandHandler:new pe(a)}}const Ae=A({__name:"CarrierModal",props:{carrier:{type:ne,required:!1,default:null},mini:{type:Boolean,required:!1,default:!1}},setup(a){const{maxLength:e,required:r,rangeLength:t}=oe(),{createDeliveryCarrierCommandHandler:h,editDeliveryCarrierCommandHandler:N}=He(),{tCap:v}=ie(),D=a,H=b(()=>!!D.carrier),B=b(()=>H.value?v("deliveryCarrier.editCarrier"):v("deliveryCarrier.addCarrier")),T=b(()=>H.value?"mdi-pencil":"mdi-plus"),m=se({name:"",street:"",city:"",zip:"",country:""}),{dialog:V,formRef:$,validForm:x,loading:P,errorMessage:z,close:F,submit:j}=de(m);le(V,_=>{_&&D.carrier&&(m.name=D.carrier.name)});async function J(){await j(async _=>{H.value?await N.handle({id:D.carrier.id,name:_.name}):await h.handle({name:_.name,address:{id:"",isPrimary:!0,street:_.street,city:_.city,zip:_.zip,country:_.country}})})}return(_,d)=>{const S=c("v-btn"),w=c("v-text-field"),g=c("v-col"),Q=c("v-row"),W=c("v-alert"),X=c("v-container"),Y=c("v-form"),Z=c("v-card-text"),G=c("v-spacer"),K=c("v-card-actions"),ee=c("v-card"),re=c("v-dialog");return p(),k(re,{modelValue:n(V),"onUpdate:modelValue":d[6]||(d[6]=s=>O(V)?V.value=s:null),"max-width":"500"},{activator:l(({props:s})=>[a.mini?C("",!0):(p(),k(S,R({key:0},s,{color:"indigo",text:B.value,"prepend-icon":T.value,variant:"flat"}),null,16,["text","prepend-icon"])),a.mini?(p(),k(S,R({key:1},s,{color:"surface-variant",icon:T.value,variant:"text",density:"compact"}),null,16,["icon"])):C("",!0)]),default:l(()=>[i(ee,{title:B.value},{default:l(()=>[i(Z,null,{default:l(()=>[i(Y,{ref_key:"formRef",ref:$,modelValue:n(x),"onUpdate:modelValue":d[5]||(d[5]=s=>O(x)?x.value=s:null)},{default:l(()=>[i(X,{class:"pa-0",fluid:""},{default:l(()=>[i(Q,{dense:""},{default:l(()=>[i(g,{cols:"12"},{default:l(()=>[i(w,{modelValue:m.name,"onUpdate:modelValue":d[0]||(d[0]=s=>m.name=s),label:n(v)("common.name"),rules:[n(r),n(t)(3,50)]},null,8,["modelValue","label","rules"])]),_:1}),H.value?C("",!0):(p(),f(ce,{key:0},[i(g,{cols:"12"},{default:l(()=>[i(w,{modelValue:m.street,"onUpdate:modelValue":d[1]||(d[1]=s=>m.street=s),label:n(v)("address.street"),rules:[n(r),n(t)(3,50)]},null,8,["modelValue","label","rules"])]),_:1}),i(g,{cols:"8"},{default:l(()=>[i(w,{modelValue:m.city,"onUpdate:modelValue":d[2]||(d[2]=s=>m.city=s),label:n(v)("address.city"),rules:[n(r),n(t)(3,50)]},null,8,["modelValue","label","rules"])]),_:1}),i(g,{cols:"4"},{default:l(()=>[i(w,{modelValue:m.zip,"onUpdate:modelValue":d[3]||(d[3]=s=>m.zip=s),label:n(v)("address.zip"),rules:[n(e)(50)]},null,8,["modelValue","label","rules"])]),_:1}),i(g,{cols:"12"},{default:l(()=>[i(w,{modelValue:m.country,"onUpdate:modelValue":d[4]||(d[4]=s=>m.country=s),label:n(v)("address.country"),rules:[n(e)(50)]},null,8,["modelValue","label","rules"])]),_:1})],64))]),_:1}),n(z)?(p(),k(W,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-2"},{default:l(()=>[ue(I(n(z)),1)]),_:1})):C("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),i(K,null,{default:l(()=>[i(G),i(S,{variant:"tonal",color:"indigo",text:n(v)("common.save"),loading:n(P),disabled:!n(x)||n(P),onClick:J},null,8,["text","loading","disabled"]),i(S,{text:n(v)("common.cancel"),color:"red",disabled:n(P),onClick:n(F)},null,8,["text","disabled","onClick"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),Ve=["href"],Be=A({__name:"PhoneLink",props:{phone:{}},setup(a){const e=a;return(r,t)=>{const h=c("v-icon");return p(),f("div",null,[i(h,{icon:"mdi-phone",size:"16",class:"mr-1 text-grey"}),M("a",{href:`tel:${e.phone.value}`,class:"text-decoration-none text-body-2",onClick:t[0]||(t[0]=L(()=>{},["stop"]))},I(e.phone.value),9,Ve)])}}}),xe={key:0},Se=["href"],ke={key:0},be={key:1},Pe={key:2},Te=A({__name:"AddressLink",props:{address:{},format:{}},setup(a){function e(r){return`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(r)}`}return(r,t)=>{const h=c("v-icon");return a.address?(p(),f("div",xe,[i(h,{icon:"mdi-map-marker",size:"16",class:"mr-1 text-grey"}),M("a",{href:e(a.address.value),target:"_blank",rel:"noopener noreferrer",class:"text-decoration-none text-body-2",onClick:t[0]||(t[0]=L(()=>{},["stop"]))},[a.format==="full"?(p(),f("span",ke,I(a.address.value),1)):C("",!0),a.format==="street"?(p(),f("span",be,I(a.address.street),1)):C("",!0),a.format==="city"?(p(),f("span",Pe,I(a.address.city),1)):C("",!0)],8,Se)])):C("",!0)}}});export{Ae as _,Te as a,Be as b,He as u};
