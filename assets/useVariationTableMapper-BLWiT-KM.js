import{a9 as w,C as m,aa as k,O as M,ab as B,ac as H,ad as U,ae as Y,af as z,Y as N,Q as j,g as R,ag as Q,a8 as $,ah as c,d as v,m as T,l as C,u as f,q as P,y as q,z as b,o as u,c as p,a2 as D,_ as I,r as W,w as X,n as Z,x as y,B as O,I as _,J as S,a3 as F,a5 as G}from"./index-HwQ46i-8.js";function J(e){const t=w();return m(()=>t.orders.find(r=>r.id===e))}function ee(e){const t=w();return m(()=>t.orders.filter(r=>r.partnerId===e))}class te{static async getNext(t){const r=new Date().getFullYear()%100,n=await k.load(),a=await M.getById(t);if(!a)throw new Error(`Partner with id:${t} doesn't exist`);const i=n.filter(o=>o.partnerId===t);if(i.length===0)return B.create(r,a.clientNumber,1);const l=i.map(o=>o.sequence).filter(o=>o.year===r).sort((o,s)=>o.format().localeCompare(s.format())).at(-1);if(!l)throw new Error("error with find the sequence");return B.create(r,a.clientNumber,l.value+1)}}class re{constructor(t=w()){this._orderStore=t}async handle(t){const r=t.items.map(i=>H(i.name,i.variations.map(l=>new U(l.quantity,l.price,l.attributes)))),n=await te.getNext(t.partnerId),a=Y(t.partnerId,n,r,t.vatRate,t.dueDate,t.notes,t.discountAmount,t.depositAmount);await k.add(a),this._orderStore.add(z.toDTO(a))}}class ne{constructor(t=w()){this._orderStore=t}async handle(t){await k.remove(t.id),this._orderStore.remove(t.id)}}function Se(){const e=w(),{allOrders:t}=N(e),r=j(),{all:n}=N(r),{tCap:a}=R();return{allOrders:m(()=>t.value.map(z.toModel)),partners:m(()=>n.value),totalsPerPartner:m(()=>e.totalsPerPartner),globalTotals:m(()=>e.globalTotals),creditOrders:e.creditOrders,debitOrders:e.debitOrders,totalCredited:e.totalCredited,totalDebited:e.totalDebited,balance:e.balance,partnersToItemProps:ae(a),getOrderById:J,getOrdersForPartner:ee,createCreditOrderCommmandHandler:new re(e),deleteOrderCommmandHandler:new ne(e)}}function ae(e){return t=>{if(t)return{title:t.businessName||t.contactName,value:t.id,subtitle:e(Q(t.type))}}}function Ve(e){const t=w(),r=m(()=>t.getOrderById(e)),n=m(()=>{const a=r.value;if(a)return z.toModel(a)});return{dto:r,model:n}}function oe(e){switch(e){case c.Draft:return"indigo";case c.Cancelled:return"red";case c.Approved:case c.Processing:case c.ReadyForShipment:case c.Shipped:return"warning";case c.Completed:default:return"grey"}}function ke(e){return e.toLocaleDateString()}function ze(e){return`${e.toFixed(2)}€`}function se(e,t){switch(e){case c.Draft:return t("order.draft");case c.Cancelled:return t("order.cancelled");case c.Approved:return t("order.approved");case c.Processing:return t("order.processing");case c.ReadyForShipment:return t("order.readyForShipment");case c.Shipped:return t("order.shipped");case c.Completed:return t("order.completed")}}function ie(e,t){switch(e){case $.Credit:return t("common.credit");case $.Debit:return t("common.debit")}}const Re=v({__name:"StatusChip",props:{status:{}},setup(e){const{tCap:t}=R();return(r,n)=>{const a=C("v-chip");return u(),T(a,{color:f(oe)(e.status)},{default:P(()=>[q(b(f(se)(e.status,f(t))),1)]),_:1},8,["color"])}}}),Pe=v({__name:"DirectionChip",props:{direction:{}},setup(e){const{tCap:t}=R();return(r,n)=>{const a=C("v-chip");return u(),T(a,{variant:"outlined"},{default:P(()=>[q(b(f(ie)(e.direction,f(t))),1)]),_:1})}}}),le=v({__name:"TextRenderer",props:{modelValue:{},width:{}},setup(e){return(t,r)=>(u(),p("span",{class:"text-renderer",style:D({width:e.width||"1vw"})},b(e.modelValue),5))}}),ue=I(le,[["__scopeId","data-v-1a107f6e"]]);var h=(e=>(e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right",e))(h||{});function de(e,t={}){const{allowArrowNavigation:r=!0}=t;function n(a){let i=null;switch(a.key){case"Enter":i=a.shiftKey?h.Up:h.Down;break;case"Tab":i=a.shiftKey?h.Left:h.Right;break}i!==null&&(a.preventDefault(),e("navigate",i))}return{onKeydown:n}}function De(e){return e.map(t=>({id:t.id,cells:t.cells.map(r=>({value:r}))}))}function Ie(e){return e.map(t=>({id:t.id,cells:t.cells.map(r=>r.value)}))}const ce=v({__name:"PriceRenderer",props:{modelValue:{},width:{}},setup(e){const t=e,r=m(()=>{const n=parseFloat(t.modelValue);return isNaN(n)?"0.00 €":`${n.toFixed(2)} €`});return(n,a)=>(u(),p("span",{class:"price-renderer",style:D({width:e.width||"2vw"})},b(r.value),5))}}),pe=I(ce,[["__scopeId","data-v-543ebf0b"]]),me=v({__name:"CheckboxRenderer",props:{modelValue:{},focused:{type:Boolean},width:{},readonly:{type:Boolean}},emits:["update:modelValue","blur","navigate"],setup(e,{emit:t}){const r=e,n=t,{onKeydown:a}=de(n);function i(o){switch(o.key){case" ":o.preventDefault(),n("update:modelValue",!r.modelValue);return;case"Enter":o.preventDefault(),n("update:modelValue",!r.modelValue),n("navigate",h.Down);return}a(o)}const l=W(null);return X(()=>r.focused,async o=>{o&&(await Z(),l.value?.$el?.querySelector('input[type="checkbox"]')?.focus())}),(o,s)=>{const d=C("v-checkbox");return u(),T(d,{ref_key:"checkboxRef",ref:l,"model-value":e.modelValue,"onUpdate:modelValue":s[0]||(s[0]=g=>o.$emit("update:modelValue",g)),density:"compact","hide-details":"",tabindex:"0",onKeydown:i,style:D({width:e.width||"1vw"}),readonly:e.readonly},null,8,["model-value","style","readonly"])}}}),ye={text:ue,price:pe,checkbox:me},he={key:0},fe={key:1},be={key:0},we={key:1},ve=v({__name:"BaseTable",props:{modelValue:{},tableColumns:{},hideRowIndex:{type:Boolean}},setup(e){function t(r,n,a){return n.calculate?n.calculate(r):a}return(r,n)=>{const a=C("v-table");return e.tableColumns.length>0?(u(),T(a,{key:0,class:"base-table",density:"compact",striped:"even"},{default:P(()=>[O("thead",null,[O("tr",null,[e.hideRowIndex!==!0?(u(),p("th",he,"#")):y("",!0),(u(!0),p(S,null,_(e.tableColumns,(i,l)=>(u(),p("th",{key:l},b(i.title),1))),128)),r.$slots.actions?(u(),p("th",fe)):y("",!0)])]),O("tbody",null,[(u(!0),p(S,null,_(e.modelValue,(i,l)=>(u(),p("tr",{key:l},[e.hideRowIndex!==!0?(u(),p("td",be,b(l+1),1)):y("",!0),(u(!0),p(S,null,_(i.cells,(o,s)=>F(r.$slots,"cell",{key:s,row:i,column:e.tableColumns[s],cell:o,rowIndex:l,colIndex:s},()=>[e.tableColumns[s].rendererType?(u(),p("td",{key:s},[(u(),T(G(f(ye)[e.tableColumns[s].rendererType]),{"model-value":t(i,e.tableColumns[s],o.value),width:e.tableColumns[s].width,readonly:!0},null,8,["model-value","width"]))])):y("",!0)],!0)),128)),r.$slots.actions?(u(),p("td",we,[F(r.$slots,"actions",{row:i,rowIndex:l},void 0,!0)])):y("",!0)]))),128))])]),_:3})):y("",!0)}}}),Be=I(ve,[["__scopeId","data-v-e3b8abb4"]]),ge={name:"colour",title:"Χρώμα",type:"variation",editorType:"autocomplete",rendererType:"text",navigable:!0,width:"4vw",list:["BLK","WILD","F","KIT.TZIN","GLOW","BL","ΚΦ","ΒΕΡ. ΝΑΠΑ","ΣΑ.ΤΖΙΝ","ΣΑ","ΚΝΛ","ΨΗΦ","OL","X","XK","ΤΑΜΠΑ.Ψ","ΓΚΡΙ","ΜΝΤ","ΚΙΤ.ΤΖΙΝ","ΚΦ.ΝΑΙΡ"]},Te={name:"sole",title:"Σόλα",type:"variation",editorType:"autocomplete",rendererType:"text",navigable:!0,width:"4vw",list:["anatomic","SOFT","soft","vamos","VAMOS","FIESTA","fiesta","SAND","sand"]},xe={name:"men",title:"Men",type:"variation",rendererType:"checkbox",navigable:!0,width:"1vw"},x=[{name:"shoe:35",title:"35",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:36",title:"36",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:37",title:"37",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:38",title:"38",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:39",title:"39",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:40",title:"40",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:41",title:"41",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:42",title:"42",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:43",title:"43",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:44",title:"44",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:45",title:"45",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:46",title:"46",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:47",title:"47",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"}],E=[{order:0,...ge},{order:1,...Te},{order:2,...xe},...x.map((e,t)=>({order:t+3,...e})),{order:x.length+3,title:"Τεμάχια Παραλλαγής",name:"calculated:totalQty",type:"calculated",rendererType:"text",width:"2vw",calculate:K},{order:x.length+4,title:"Τιμή Παραλλαγής",name:"variationPrice",type:"price",editorType:"price",rendererType:"price",navigable:!0,width:"2.5vw"},{order:x.length+5,title:"Σύνολο Παραλλαγής",name:"calculated:totalPrice",type:"calculated",rendererType:"price",width:"3vw",calculate:Ce}].sort((e,t)=>e.order-t.order);function K(e){let t=0;return E.forEach((r,n)=>{r.type==="size"&&(t+=Number(e.cells[n].value)||0)}),t.toString()}function Ce(e){const t=Number(K(e))||0,r=E.findIndex(a=>a.name==="variationPrice");if(r===-1)return"";const n=Number(e.cells[r].value)||0;return(t*n).toString()}function Ne(e){const t=e.filter(o=>o.type==="variation"),r=e.filter(o=>o.type==="size"),n=e.find(o=>o.type==="price");function a(o){return o.map(s=>({cells:e.map(d=>r.includes(d)?L(s.sizing,d.name):d===n?V(s.price):s.attributes[d.name]||"")}))}function i(o){return o.map(s=>({cells:e.map(d=>r.includes(d)?L(s.sizing,d.name):d===n?V(s.price):s.attributes[d.name]||"")}))}function l(o){return o.map(s=>({attributes:Object.fromEntries(t.map((d,g)=>[d.name,s.cells[g]])),sizing:Object.fromEntries(r.map((d,g)=>[d.name,A(s.cells[g+t.length])])),price:s.cells[e.indexOf(n)]?A(s.cells[e.indexOf(n)]):0}))}return{regVmToRows:i,vmToRows:a,rowsToVm:l}}function L(e,t){const r=Oe(e,t);return V(r)}function Oe(e,t){const r=e[t];return r||0}function A(e){return e&&e!==""?Number(e):0}function V(e){return e>0?e.toString():""}function $e(e){return Object.values(e.sizing).reduce((t,r)=>t+r,0)}export{Be as B,h as N,ue as T,Pe as _,Re as a,de as b,De as c,Ne as d,E as e,ze as f,ke as g,Ve as h,ye as r,$e as s,Ie as t,Se as u};
