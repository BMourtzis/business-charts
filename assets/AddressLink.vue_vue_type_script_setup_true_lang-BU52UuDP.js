import{Z as u,a0 as o,$ as p,V as E,a1 as ae,T as U,U as q,Y as te,C as b,d as A,Q as ne,f as oe,g as ie,j as se,k as le,w as de,m as S,l as c,u as n,p as O,q as d,e as i,x as C,c as g,J as ce,y as ue,z as k,A as R,o as _,B as M,H as $}from"./index-CuyDnXgR.js";class me{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=E(e.street,e.city,e.zip,e.country,e.isPrimary,e.name);return r.addAddress(t),await o.update(r),this._carrierStore.update(p.toDTO(r)),r}}class pe{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=E(e.street,e.city,e.zip,e.country,e.isPrimary,e.name);return r.editAddress(e.addressId,t),await o.update(r),this._carrierStore.update(p.toDTO(r)),r}}class ye{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(r)return r.removeAddress(e.addressId),await o.update(r),this._carrierStore.update(p.toDTO(r)),r}}class ve{constructor(e=u()){this._deliveryCarrierStore=e}async handle(e){const r=E(e.address.street,e.address.city,e.address.zip,e.address.country,e.address.isPrimary,e.address.name),t=ae(e.name,r);return await o.add(t),this._deliveryCarrierStore.add(p.toDTO(t)),t}}class _e{constructor(e=u()){this._deliveryCarrierStore=e}async handle(e){await o.remove(e.id),this._deliveryCarrierStore.remove(e.id)}}class Ce{constructor(e=u()){this._deliveryCarrierStore=e}async handle(e){const r=await o.getById(e.id);if(r)return r.name=e.name,await o.update(r),this._deliveryCarrierStore.update(p.toDTO(r)),r}}class fe{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=U(e.email,e.isPrimary,e.name);return r.addEmail(t),await o.update(r),this._carrierStore.update(p.toDTO(r)),r}}class he{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=U(e.email,e.isPrimary,e.name);return r.editEmail(e.emailId,t),await o.update(r),this._carrierStore.update(p.toDTO(r)),r}}class we{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(r)return r.removeEmail(e.emailId),await o.update(r),this._carrierStore.update(p.toDTO(r)),r}}class ge{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=q(e.phone,e.isPrimary,e.name);return r.addPhone(t),await o.update(r),this._carrierStore.update(p.toDTO(r)),r}}class He{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(!r)return;const t=q(e.phone,e.isPrimary,e.name);return r.editPhone(e.phoneId,t),await o.update(r),this._carrierStore.update(p.toDTO(r)),r}}class Ie{constructor(e=u()){this._carrierStore=e}async handle(e){const r=await o.getById(e.carrierId);if(r)return r.removePhone(e.phoneId),await o.update(r),this._carrierStore.update(p.toDTO(r)),r}}function De(){const a=u(),{all:e}=te(a);return{carriers:b(()=>e.value.map(p.toModel)),createDeliveryCarrierCommandHandler:new ve(a),editDeliveryCarrierCommandHandler:new Ce(a),deleteDeliveryCarrierCommandHandler:new _e(a),addEmailCommandHandler:new fe(a),editEmailCommandHandler:new he(a),removeEmailCommandHandler:new we(a),addPhoneCommandHandler:new ge(a),editPhoneCommandHandler:new He(a),removePhoneCommandHandler:new Ie(a),addAddressCommandHandler:new me(a),editAddressCommandHandler:new pe(a),removeAddressCommandHandler:new ye(a)}}const Ee=A({__name:"CarrierModal",props:{carrier:{type:ne,required:!1,default:null},mini:{type:Boolean,required:!1,default:!1}},setup(a){const{maxLength:e,required:r,rangeLength:t}=oe(),{createDeliveryCarrierCommandHandler:f,editDeliveryCarrierCommandHandler:L}=De(),{tCap:y}=ie(),H=a,I=b(()=>!!H.carrier),B=b(()=>I.value?y("deliveryCarrier.editCarrier"):y("deliveryCarrier.addCarrier")),T=b(()=>I.value?"mdi-pencil":"mdi-plus"),m=se({name:"",street:"",city:"",zip:"",country:""}),{dialog:D,formRef:N,validForm:V,loading:P,errorMessage:z,close:F,submit:j}=le(m);de(D,v=>{v&&H.carrier&&(m.name=H.carrier.name)});async function J(){await j(async v=>{I.value?await L.handle({id:H.carrier.id,name:v.name}):await f.handle({name:v.name,address:{id:"",isPrimary:!0,street:v.street,city:v.city,zip:v.zip,country:v.country}})})}return(v,l)=>{const x=c("v-btn"),h=c("v-text-field"),w=c("v-col"),Q=c("v-row"),Y=c("v-alert"),Z=c("v-container"),G=c("v-form"),K=c("v-card-text"),W=c("v-spacer"),X=c("v-card-actions"),ee=c("v-card"),re=c("v-dialog");return _(),S(re,{modelValue:n(D),"onUpdate:modelValue":l[6]||(l[6]=s=>O(D)?D.value=s:null),"max-width":"500"},{activator:d(({props:s})=>[a.mini?C("",!0):(_(),S(x,R({key:0},s,{color:"indigo",text:B.value,"prepend-icon":T.value,variant:"flat"}),null,16,["text","prepend-icon"])),a.mini?(_(),S(x,R({key:1},s,{color:"surface-variant",icon:T.value,variant:"text",density:"compact"}),null,16,["icon"])):C("",!0)]),default:d(()=>[i(ee,{title:B.value},{default:d(()=>[i(K,null,{default:d(()=>[i(G,{ref_key:"formRef",ref:N,modelValue:n(V),"onUpdate:modelValue":l[5]||(l[5]=s=>O(V)?V.value=s:null)},{default:d(()=>[i(Z,{class:"pa-0",fluid:""},{default:d(()=>[i(Q,{dense:""},{default:d(()=>[i(w,{cols:"12"},{default:d(()=>[i(h,{modelValue:m.name,"onUpdate:modelValue":l[0]||(l[0]=s=>m.name=s),label:n(y)("common.name"),rules:[n(r),n(t)(3,50)]},null,8,["modelValue","label","rules"])]),_:1}),I.value?C("",!0):(_(),g(ce,{key:0},[i(w,{cols:"12"},{default:d(()=>[i(h,{modelValue:m.street,"onUpdate:modelValue":l[1]||(l[1]=s=>m.street=s),label:n(y)("address.street"),rules:[n(r),n(t)(3,50)]},null,8,["modelValue","label","rules"])]),_:1}),i(w,{cols:"8"},{default:d(()=>[i(h,{modelValue:m.city,"onUpdate:modelValue":l[2]||(l[2]=s=>m.city=s),label:n(y)("address.city"),rules:[n(r),n(t)(3,50)]},null,8,["modelValue","label","rules"])]),_:1}),i(w,{cols:"4"},{default:d(()=>[i(h,{modelValue:m.zip,"onUpdate:modelValue":l[3]||(l[3]=s=>m.zip=s),label:n(y)("address.zip"),rules:[n(e)(50)]},null,8,["modelValue","label","rules"])]),_:1}),i(w,{cols:"12"},{default:d(()=>[i(h,{modelValue:m.country,"onUpdate:modelValue":l[4]||(l[4]=s=>m.country=s),label:n(y)("address.country"),rules:[n(e)(50)]},null,8,["modelValue","label","rules"])]),_:1})],64))]),_:1}),n(z)?(_(),S(Y,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-2"},{default:d(()=>[ue(k(n(z)),1)]),_:1})):C("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),i(X,null,{default:d(()=>[i(W),i(x,{variant:"tonal",color:"indigo",text:n(y)("common.save"),loading:n(P),disabled:!n(V)||n(P),onClick:J},null,8,["text","loading","disabled"]),i(x,{text:n(y)("common.cancel"),color:"red",disabled:n(P),onClick:n(F)},null,8,["text","disabled","onClick"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),Ve=["href"],Ae=A({__name:"PhoneLink",props:{phone:{}},setup(a){const e=a;return(r,t)=>{const f=c("v-icon");return _(),g("div",null,[i(f,{icon:"mdi-phone",size:"16",class:"mr-1 text-grey"}),M("a",{href:`tel:${e.phone.value}`,class:"text-decoration-none text-body-2",onClick:t[0]||(t[0]=$(()=>{},["stop"]))},k(e.phone.value),9,Ve)])}}}),xe={key:0},Se=["href"],be={key:0},ke={key:1},Be=A({__name:"AddressLink",props:{address:{},format:{}},setup(a){function e(r){return`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(r)}`}return(r,t)=>{const f=c("v-icon");return a.address?.street?(_(),g("div",xe,[i(f,{icon:"mdi-map-marker",size:"16",class:"mr-1 text-grey"}),M("a",{href:e(a.address.value),target:"_blank",rel:"noopener noreferrer",class:"text-decoration-none text-body-2",onClick:t[0]||(t[0]=$(()=>{},["stop"]))},[a.format==="full"?(_(),g("span",be,k(a.address.value),1)):C("",!0),a.format==="street"?(_(),g("span",ke,k(a.address.street),1)):C("",!0)],8,Se)])):C("",!0)}}});export{Ee as _,Be as a,Ae as b,De as u};
