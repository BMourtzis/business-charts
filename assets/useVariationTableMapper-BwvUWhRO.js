import{aa as w,C as p,ab as V,O as G,ac as I,ad as U,ae as Y,af as Q,ag as z,Y as B,Q as W,g as P,ah as X,a9 as N,ai as d,d as v,m as T,l as O,u as f,q as R,y as q,z as b,o as c,c as m,a3 as D,_ as L,r as J,w as Z,n as ee,x as y,B as C,I as S,J as _,a4 as $,a6 as te}from"./index-DLPsEI6P.js";function re(e){const t=w();return p(()=>t.orders.find(r=>r.id===e))}function ne(e){const t=w();return p(()=>t.orders.filter(r=>r.partnerId===e))}class ae{static async getNext(t){const r=new Date().getFullYear()%100,o=await V.load(),n=await G.getById(t);if(!n)throw new Error(`Partner with id:${t} doesn't exist`);const i=o.filter(a=>a.partnerId===t);if(i.length===0)return I.create(r,n.clientNumber,1);const l=i.map(a=>a.sequence).filter(a=>a.year===r).sort((a,s)=>a.format().localeCompare(s.format())).at(-1);if(!l)throw new Error("error with find the sequence");return I.create(r,n.clientNumber,l.value+1)}}class oe{constructor(t=w()){this._orderStore=t}async handle(t){const r=t.items.map(i=>U(i.name,i.variations.map(l=>new Y(l.quantity,l.price,l.attributes)))),o=await ae.getNext(t.partnerId),n=Q(t.partnerId,o,r,t.vatRate,t.dueDate,t.notes,t.discountAmount,t.depositAmount);await V.add(n),this._orderStore.add(z.toDTO(n))}}class se{constructor(t=w()){this._orderStore=t}async handle(t){await V.remove(t.id),this._orderStore.remove(t.id)}}function Re(){const e=w(),{allOrders:t}=B(e),r=W(),{all:o}=B(r),{tCap:n}=P();return{allOrders:p(()=>t.value.map(z.toModel)),partners:p(()=>o.value),totalsPerPartner:p(()=>e.totalsPerPartner),globalTotals:p(()=>e.globalTotals),creditOrders:e.creditOrders,debitOrders:e.debitOrders,totalCredited:e.totalCredited,totalDebited:e.totalDebited,balance:e.balance,partnersToItemProps:ie(n),getOrderById:re,getOrdersForPartner:ne,createCreditOrderCommmandHandler:new oe(e),deleteOrderCommmandHandler:new se(e)}}function ie(e){return t=>{if(t)return{title:t.businessName||t.contactName,value:t.id,subtitle:e(X(t.type))}}}function le(e){const t=parseFloat(e);return E(t)}function E(e){if(isNaN(e))return`0,00 ${F()}`;const t=e.toFixed(2);return`${K(t)} ${F()}`}function De(e){return K(e)}function Le(e){return ce(e)}function K(e){return e.replace(".",",")}function ce(e){return e.replace(",",".")}function F(){return"€"}function Ie(e){const t=w(),r=p(()=>t.getOrderById(e)),o=p(()=>{const n=r.value;if(n)return z.toModel(n)});return{dto:r,model:o}}function ue(e){switch(e){case d.Draft:return"indigo";case d.Cancelled:return"red";case d.Approved:case d.Processing:case d.ReadyForShipment:case d.Shipped:return"warning";case d.Completed:default:return"grey"}}function Be(e){return e.toLocaleDateString()}function Ne(e){return E(e)}function de(e,t){switch(e){case d.Draft:return t("order.draft");case d.Cancelled:return t("order.cancelled");case d.Approved:return t("order.approved");case d.Processing:return t("order.processing");case d.ReadyForShipment:return t("order.readyForShipment");case d.Shipped:return t("order.shipped");case d.Completed:return t("order.completed")}}function me(e,t){switch(e){case N.Credit:return t("common.credit");case N.Debit:return t("common.debit")}}const $e=v({__name:"StatusChip",props:{status:{}},setup(e){const{tCap:t}=P();return(r,o)=>{const n=O("v-chip");return c(),T(n,{color:f(ue)(e.status)},{default:R(()=>[q(b(f(de)(e.status,f(t))),1)]),_:1},8,["color"])}}}),Fe=v({__name:"DirectionChip",props:{direction:{}},setup(e){const{tCap:t}=P();return(r,o)=>{const n=O("v-chip");return c(),T(n,{variant:"outlined"},{default:R(()=>[q(b(f(me)(e.direction,f(t))),1)]),_:1})}}}),pe=v({__name:"TextRenderer",props:{modelValue:{},width:{}},setup(e){return(t,r)=>(c(),m("span",{class:"text-renderer",style:D({width:e.width||"1vw"})},b(e.modelValue),5))}}),ye=L(pe,[["__scopeId","data-v-1a107f6e"]]);var h=(e=>(e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right",e))(h||{});function he(e,t={}){const{allowArrowNavigation:r=!0}=t;function o(n){let i=null;switch(n.key){case"Enter":i=n.shiftKey?h.Up:h.Down;break;case"Tab":i=n.shiftKey?h.Left:h.Right;break}i!==null&&(n.preventDefault(),e("navigate",i))}return{onKeydown:o}}function Ae(e){return e.map(t=>({id:t.id,cells:t.cells.map(r=>({value:r}))}))}function Me(e){return e.map(t=>({id:t.id,cells:t.cells.map(r=>r.value)}))}const fe=v({__name:"PriceRenderer",props:{modelValue:{},width:{}},setup(e){const t=e,r=p(()=>le(t.modelValue));return(o,n)=>(c(),m("span",{class:"price-renderer",style:D({width:e.width||"2vw"})},b(r.value),5))}}),be=L(fe,[["__scopeId","data-v-2b15d027"]]),we=v({__name:"CheckboxRenderer",props:{modelValue:{},focused:{type:Boolean},width:{},readonly:{type:Boolean}},emits:["update:modelValue","blur","navigate"],setup(e,{emit:t}){const r=e,o=t,{onKeydown:n}=he(o);function i(a){switch(a.key){case" ":a.preventDefault(),o("update:modelValue",!r.modelValue);return;case"Enter":a.preventDefault(),o("update:modelValue",!r.modelValue),o("navigate",h.Down);return}n(a)}const l=J(null);return Z(()=>r.focused,async a=>{a&&(await ee(),l.value?.$el?.querySelector('input[type="checkbox"]')?.focus())}),(a,s)=>{const u=O("v-checkbox");return c(),T(u,{ref_key:"checkboxRef",ref:l,"model-value":e.modelValue,"onUpdate:modelValue":s[0]||(s[0]=g=>a.$emit("update:modelValue",g)),density:"compact","hide-details":"",tabindex:"0",onKeydown:i,style:D({width:e.width||"1vw"}),readonly:e.readonly},null,8,["model-value","style","readonly"])}}}),ve={text:ye,price:be,checkbox:we},ge={key:0},Te={key:1},xe={key:0},Oe={key:1},Ce=v({__name:"BaseTable",props:{modelValue:{},tableColumns:{},hideRowIndex:{type:Boolean}},setup(e){function t(r,o,n){return o.calculate?o.calculate(r):n}return(r,o)=>{const n=O("v-table");return e.tableColumns.length>0?(c(),T(n,{key:0,class:"base-table",density:"compact",striped:"even"},{default:R(()=>[C("thead",null,[C("tr",null,[e.hideRowIndex!==!0?(c(),m("th",ge,"#")):y("",!0),(c(!0),m(_,null,S(e.tableColumns,(i,l)=>(c(),m("th",{key:l},b(i.title),1))),128)),r.$slots.actions?(c(),m("th",Te)):y("",!0)])]),C("tbody",null,[(c(!0),m(_,null,S(e.modelValue,(i,l)=>(c(),m("tr",{key:l},[e.hideRowIndex!==!0?(c(),m("td",xe,b(l+1),1)):y("",!0),(c(!0),m(_,null,S(i.cells,(a,s)=>$(r.$slots,"cell",{key:s,row:i,column:e.tableColumns[s],cell:a,rowIndex:l,colIndex:s},()=>[e.tableColumns[s].rendererType?(c(),m("td",{key:s},[(c(),T(te(f(ve)[e.tableColumns[s].rendererType]),{"model-value":t(i,e.tableColumns[s],a.value),width:e.tableColumns[s].width,readonly:!0},null,8,["model-value","width"]))])):y("",!0)],!0)),128)),r.$slots.actions?(c(),m("td",Oe,[$(r.$slots,"actions",{row:i,rowIndex:l},void 0,!0)])):y("",!0)]))),128))])]),_:3})):y("",!0)}}}),qe=L(Ce,[["__scopeId","data-v-e3b8abb4"]]),Se={name:"colour",title:"Χρώμα",type:"variation",editorType:"autocomplete",rendererType:"text",navigable:!0,width:"4vw",list:["WILD","F","GLOW","BL","ΚΦ","ΒΕΡ. ΝΑΠΑ","ΣΑ.ΤΖΙΝ","ΣΑ","ΚΝΛ","ΨΗΦ","OL","X","XK","ΤΑΜΠΑ.ΨΑΘΑ","ΓΚΡΙ","ΜΝΤ","ΚΙΤ.ΤΖΙΝ","ΚΦ.ΝΑΙΡ","CAM","LIM.ΚΡ","ROSE.ΚΡ","Χ.ΝΑΠΑ","ΤΑΜΠΑ.ΚΡ","OL.ΚΡ","ΚΥΡ.ΝΑΙΡ","Μ","ΓΚΡΙ.ΝΑΙΡ","ΓΚΡΙ.ΚΡ"]},_e={name:"sole",title:"Σόλα",type:"variation",editorType:"autocomplete",rendererType:"text",navigable:!0,width:"4vw",list:["anatomic","soft","SOFT","vamos","VAMOS","fiesta","FIESTA","sand","SAND","momo","MOMO","esp"]},ke={name:"men",title:"Men",type:"variation",rendererType:"checkbox",navigable:!0,width:"1vw"},x=[{name:"shoe:35",title:"35",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:36",title:"36",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:37",title:"37",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:38",title:"38",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:39",title:"39",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:40",title:"40",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:41",title:"41",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:42",title:"42",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:43",title:"43",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:44",title:"44",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:45",title:"45",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:46",title:"46",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:47",title:"47",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"}],H=[{order:0,...Se},{order:1,..._e},{order:2,...ke},...x.map((e,t)=>({order:t+3,...e})),{order:x.length+3,title:"Τεμάχια Παραλλαγής",name:"calculated:totalQty",type:"calculated",rendererType:"text",width:"2vw",calculate:j},{order:x.length+4,title:"Τιμή Παραλλαγής",name:"variationPrice",type:"price",editorType:"price",rendererType:"price",navigable:!0,width:"2.5vw"},{order:x.length+5,title:"Σύνολο Παραλλαγής",name:"calculated:totalPrice",type:"calculated",rendererType:"price",width:"3vw",calculate:Ve}].sort((e,t)=>e.order-t.order);function j(e){let t=0;return H.forEach((r,o)=>{r.type==="size"&&(t+=Number(e.cells[o].value)||0)}),t.toString()}function Ve(e){const t=Number(j(e))||0,r=H.findIndex(n=>n.name==="variationPrice");if(r===-1)return"";const o=Number(e.cells[r].value)||0;return(t*o).toString()}function Ee(e){const t=e.filter(a=>a.type==="variation"),r=e.filter(a=>a.type==="size"),o=e.find(a=>a.type==="price");function n(a){return a.map(s=>({cells:e.map(u=>r.includes(u)?A(s.sizing,u.name):u===o?k(s.price):s.attributes[u.name]||"")}))}function i(a){return a.map(s=>({cells:e.map(u=>r.includes(u)?A(s.sizing,u.name):u===o?k(s.price):s.attributes[u.name]||"")}))}function l(a){return a.map(s=>({attributes:Object.fromEntries(t.map((u,g)=>[u.name,s.cells[g]])),sizing:Object.fromEntries(r.map((u,g)=>[u.name,M(s.cells[g+t.length])])),price:s.cells[e.indexOf(o)]?M(s.cells[e.indexOf(o)]):0}))}return{regVmToRows:i,vmToRows:n,rowsToVm:l}}function A(e,t){const r=ze(e,t);return k(r)}function ze(e,t){const r=e[t];return r||0}function M(e){return e&&e!==""?Number(e):0}function k(e){return e>0?e.toString():""}function Ke(e){return Object.values(e.sizing).reduce((t,r)=>t+r,0)}export{qe as B,h as N,ye as T,Fe as _,$e as a,he as b,Le as c,Ae as d,Ee as e,H as f,F as g,Be as h,De as i,Ne as j,Ie as k,E as n,ve as r,Ke as s,Me as t,Re as u};
