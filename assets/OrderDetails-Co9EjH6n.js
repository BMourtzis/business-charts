import{_ as R}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-s1rQmdsd.js";import{u as B,a as j,_ as E,f as A,h as y,d as M,B as P,e as H,s as I,j as q}from"./useVariationTableMapper-Cn69-SB2.js";import{d as C,g as z,C as S,c as x,e as o,l as c,q as a,B as i,z as r,x as b,y as v,u as n,a8 as T,J as L,F,o as m,_ as K,m as k,a7 as J,a9 as $,I as U}from"./index-B0w7ZiSN.js";import{g as G}from"./usePartnerDetails-DD5q1pN_.js";const Q={class:"mr-2"},W={key:0,class:"text-subtitle-1 text-grey-darken-1 order-details-line"},X={key:0},Y={key:1},Z={key:1,class:"text-subtitle-1 text-grey-darken-1 order-details-line"},ee={class:"text-subtitle-1 text-grey-darken-1 font-weight-bold order-details-line"},te={class:"formatted-notes"},ne={class:"text-h5 font-weight-bold"},oe={key:0},re={key:0},ae=C({__name:"OrderDetailsHeader",props:{order:{}},setup(e){const{tCap:t}=z(),d=F(),{deleteOrderCommmandHandler:_}=B(),f=e,u=S(()=>G(f.order.partnerId));function g(){return`#${f.order.orderNumber}`}function s(){d.back(),_.handle({id:f.order.id})}return(D,h)=>{const p=c("v-col"),l=c("v-row"),w=c("v-btn");return m(),x(L,null,[o(l,{align:"start",justify:"space-between",dense:""},{default:a(()=>[o(p,{cols:"5",class:"d-flex",justify:"start"},{default:a(()=>[i("h1",Q,r(g()),1),o(j,{status:e.order.status,class:"ml-2 mt-2"},null,8,["status"]),o(E,{direction:e.order.direction,class:"ml-2 mt-2"},null,8,["direction"])]),_:1}),o(p,{cols:"4",class:"d-flex flex-row justify-end"}),o(p,{cols:"1",class:"d-flex flex-row justify-end"},{default:a(()=>[o(R,{name:g(),"action-fn":()=>s(),mini:""},null,8,["name","action-fn"])]),_:1})]),_:1}),o(l,{align:"start",justify:"space-between",dense:""},{default:a(()=>[o(p,{cols:"3",class:"text-md-left"},{default:a(()=>[u.value?(m(),x("div",W,[e.order.direction===n(T).Credit?(m(),x("strong",X,r(n(t)("partner.customer")),1)):b("",!0),e.order.direction===n(T).Debit?(m(),x("strong",Y,r(n(t)("partner.customer")),1)):b("",!0),h[0]||(h[0]=v(": ",-1)),o(w,{variant:"text",to:`/partner/${u.value.id}`},{default:a(()=>[v(r(u.value.businessName),1)]),_:1},8,["to"])])):b("",!0),e.order.dueDate?(m(),x("div",Z,[i("strong",null,r(n(t)("order.dueDate")),1),v(": "+r(n(A)(e.order.dueDate)),1)])):b("",!0),i("div",ee,r(n(t)("order.notes"))+": ",1),i("span",te,r(e.order.notes),1)]),_:1}),o(p,{cols:"4",md:"5",class:"text-md-right"},{default:a(()=>[i("span",null,r(n(t)("order.total")),1),i("div",ne,r(n(y)(e.order.totalAmount)),1),i("div",null,[v(r(n(t)("order.orderSum"))+" ",1),i("strong",null,r(n(y)(e.order.subtotal)),1),v(" · "+r(n(t)("order.vatRate"))+" ",1),i("strong",null,r(n(y)(e.order.taxAmount)),1),e.order.discountAmount>0?(m(),x("span",oe,[v(" · "+r(n(t)("order.discount"))+" ",1),i("strong",null,r(n(y)(e.order.discountAmount)),1)])):b("",!0)]),e.order.depositAmount>0?(m(),x("div",re,[v(r(n(t)("order.deposit"))+" ",1),i("strong",null,r(n(y)(e.order.discountAmount)),1),v(" · "+r(n(t)("order.remainingAmount"))+" ",1),i("strong",null,r(n(y)(e.order.remainingAmount)),1)])):b("",!0)]),_:1})]),_:1})],64)}}}),se=K(ae,[["__scopeId","data-v-92f99827"]]),de=C({__name:"DisplayTable",props:{tableRows:{},tableColumns:{},hideRowIndex:{type:Boolean}},setup(e){const t=e,d=S(()=>M(t.tableRows));return(_,f)=>(m(),k(P,{modelValue:d.value,"table-columns":e.tableColumns,"hide-row-index":e.hideRowIndex},null,8,["modelValue","table-columns","hide-row-index"]))}});function le(e){const t=e.map(ce);return ie(t)}function ce(e){const t=e.sku.variationSnapshot.attributes??{},{size:d,..._}=t;return{name:e.name,unitPrice:e.unitPrice,productCode:e.productCode,derivedSku:J(e.productCode,{attributes:_,flags:e.sku.variationSnapshot.flags}),variationSnapshot:{attributes:_,flags:e.sku.variationSnapshot.flags},sizing:ue(d,e.quantity)}}function ie(e){const t=new Map;for(const d of e){const _=d.derivedSku,f=t.get(_);if(f)for(const[u,g]of Object.entries(d.sizing))f.sizing[u]=(f.sizing[u]||0)+g;else t.set(_,{...d,sizing:{...d.sizing}})}return[...t.values()]}function ue(e,t){return{[`shoe:${e}`]:t}}const me=C({__name:"OrderDetailsLineItems",props:{order:{}},setup(e){const{tCap:t}=z(),{vmToRows:d}=H(I),_=e,f=S(()=>{const u=le([..._.order.items]);return d(u)});return(u,g)=>{const s=c("v-chip"),D=c("v-list-item"),h=c("v-card-title"),p=c("v-card-text"),l=c("v-card");return m(),k(l,null,{default:a(()=>[o(h,null,{default:a(()=>[o(D,null,{title:a(()=>[i("h3",null,r(n(t)("order.items",2)),1)]),append:a(()=>[o(s,{size:"small"},{default:a(()=>[v(r(e.order.items.length),1)]),_:1})]),_:1})]),_:1}),o(p,null,{default:a(()=>[o(de,{tableRows:f.value,"table-columns":n(I)},null,8,["tableRows","table-columns"])]),_:1})]),_:1})}}}),_e={class:"d-flex"},fe={key:0,class:"me-4"},pe=C({__name:"OrderDetailsTimeline",props:{order:{}},setup(e){const{tCap:t}=z(),d=e,_=S(()=>g(d.order)),f=[{name:t("order.createdDate"),getDate:s=>s.createdDate},{name:t("order.approvedDate"),getDate:s=>s.approvedDate},{name:t("order.shippedDate"),getDate:s=>s.shippedDate},{name:t("order.completedDate"),getDate:s=>s.completedDate}],u={name:t("order.cancelledDate"),getDate:s=>s.cancelledDate,isCancelled:!0};function g(s){const D=[...f];s.status===$.Cancelled&&D.push(u);const h=D.map(l=>({name:l.name,date:l.getDate(s)})),p=h.map(l=>l.date).findLastIndex(l=>l!==void 0);return h.map((l,w)=>s.status===$.Cancelled&&l.name==="Cancelled"?{...l,colour:"red"}:l.date?{...l,colour:w===p?"indigo":"cyan"}:{...l,colour:"grey"})}return(s,D)=>{const h=c("v-card-title"),p=c("v-divider"),l=c("v-timeline-item"),w=c("v-timeline"),N=c("v-card-text"),V=c("v-card");return m(),k(V,null,{default:a(()=>[o(h,null,{default:a(()=>[v(r(n(t)("common.timeline")),1)]),_:1}),o(p),o(N,null,{default:a(()=>[o(w,{align:"start",side:"end",direction:"horizontal"},{default:a(()=>[(m(!0),x(L,null,U(_.value,O=>(m(),k(l,{"dot-color":O.colour,size:"small"},{opposite:a(()=>[i("div",null,r(O.name),1)]),default:a(()=>[i("div",_e,[O.date?(m(),x("strong",fe,r(n(A)(O.date)),1)):b("",!0)])]),_:2},1032,["dot-color"]))),256))]),_:1})]),_:1})]),_:1})}}}),be=C({__name:"OrderDetails",props:{id:{}},setup(e){const t=e,{model:d}=q(t.id);return(_,f)=>{const u=c("v-col"),g=c("v-row"),s=c("v-container");return n(d)?(m(),k(s,{key:0},{default:a(()=>[o(se,{order:n(d)},null,8,["order"]),o(g,{class:"mt-6",align:"start"},{default:a(()=>[o(u,{cols:"12"},{default:a(()=>[o(me,{order:n(d)},null,8,["order"])]),_:1}),o(u,{cols:"12",md:"12",xl:"12"},{default:a(()=>[o(pe,{order:n(d)},null,8,["order"])]),_:1})]),_:1})]),_:1})):b("",!0)}}});export{be as default};
