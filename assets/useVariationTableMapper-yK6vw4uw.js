import{aa as g,C as f,ab as z,O as ee,ac as $,ad as te,ae as re,af as D,Y as F,Q as ne,g as R,ag as ae,a8 as M,a9 as p,d as T,m as C,l as O,u as v,q as L,y as K,z as w,o as c,c as m,a3 as B,_ as I,r as oe,w as se,n as ie,x as h,B as k,I as P,J as V,a4 as A,a6 as le,a7 as ce}from"./index-CnPHzlPR.js";function ue(e){const t=g();return f(()=>t.orders.find(r=>r.id===e))}function de(e){const t=g();return f(()=>t.orders.filter(r=>r.partnerId===e))}class pe{static async getNext(t){const r=new Date().getFullYear()%100,a=await z.load(),n=await ee.getById(t);if(!n)throw new Error(`Partner with id:${t} doesn't exist`);const l=a.filter(i=>i.partnerId===t);if(l.length===0)return $.create(r,n.clientNumber,1);const d=l.map(i=>i.sequence).filter(i=>i.year===r).sort((i,u)=>i.format().localeCompare(u.format())).at(-1);if(!d)throw new Error("error with find the sequence");return $.create(r,n.clientNumber,d.value+1)}}class me{constructor(t=g()){this._orderStore=t}async handle(t){const r=t.items.map(te.toModel),a=await pe.getNext(t.partnerId),n=re(t.partnerId,a,r,t.vatRate,t.dueDate,t.notes,t.discountAmount,t.depositAmount);await z.add(n),this._orderStore.add(D.toDTO(n))}}class fe{constructor(t=g()){this._orderStore=t}async handle(t){await z.remove(t.id),this._orderStore.remove(t.id)}}function Ee(){const e=g(),{allOrders:t}=F(e),r=ne(),{all:a}=F(r),{tCap:n}=R();return{allOrders:f(()=>t.value.map(D.toModel)),partners:f(()=>a.value),totalsPerPartner:f(()=>e.totalsPerPartner),globalTotals:f(()=>e.globalTotals),creditOrders:e.creditOrders,debitOrders:e.debitOrders,totalCredited:e.totalCredited,totalDebited:e.totalDebited,balance:e.balance,partnersToItemProps:ye(n),getOrderById:ue,getOrdersForPartner:de,createCreditOrderCommmandHandler:new me(e),deleteOrderCommmandHandler:new fe(e)}}function ye(e){return t=>{if(t)return{title:t.businessName||t.contactName,value:t.id,subtitle:e(ae(t.type))}}}function he(e){const t=parseFloat(e);return U(t)}function U(e){if(isNaN(e))return`0,00 ${E()}`;const t=e.toFixed(2);return`${H(t)} ${E()}`}function qe(e){return H(e)}function Ke(e){return be(e)}function H(e){return e.replace(".",",")}function be(e){return e.replace(",",".")}function E(){return"€"}function Ue(e){const t=g(),r=f(()=>t.getOrderById(e)),a=f(()=>{const n=r.value;if(n)return D.toModel(n)});return{dto:r,model:a}}function ve(e){switch(e){case p.Draft:return"indigo";case p.Cancelled:return"red";case p.Approved:case p.Processing:case p.ReadyForShipment:case p.Shipped:return"warning";case p.Completed:default:return"grey"}}function He(e){return e.toLocaleDateString()}function je(e){return U(e)}function we(e,t){switch(e){case p.Draft:return t("order.draft");case p.Cancelled:return t("order.cancelled");case p.Approved:return t("order.approved");case p.Processing:return t("order.processing");case p.ReadyForShipment:return t("order.readyForShipment");case p.Shipped:return t("order.shipped");case p.Completed:return t("order.completed")}}function ge(e,t){switch(e){case M.Credit:return t("common.credit");case M.Debit:return t("common.debit")}}const Ge=T({__name:"StatusChip",props:{status:{}},setup(e){const{tCap:t}=R();return(r,a)=>{const n=O("v-chip");return c(),C(n,{color:v(ve)(e.status)},{default:L(()=>[K(w(v(we)(e.status,v(t))),1)]),_:1},8,["color"])}}}),Ye=T({__name:"DirectionChip",props:{direction:{}},setup(e){const{tCap:t}=R();return(r,a)=>{const n=O("v-chip");return c(),C(n,{variant:"outlined"},{default:L(()=>[K(w(v(ge)(e.direction,v(t))),1)]),_:1})}}}),Te=T({__name:"TextRenderer",props:{modelValue:{},width:{}},setup(e){return(t,r)=>(c(),m("span",{class:"text-renderer",style:B({width:e.width||"1vw"})},w(e.modelValue),5))}}),Ce=I(Te,[["__scopeId","data-v-1a107f6e"]]);var b=(e=>(e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right",e))(b||{});function xe(e,t={}){const{allowArrowNavigation:r=!0}=t;function a(n){let l=null;switch(n.key){case"Enter":l=n.shiftKey?b.Up:b.Down;break;case"Tab":l=n.shiftKey?b.Left:b.Right;break}l!==null&&(n.preventDefault(),e("navigate",l))}return{onKeydown:a}}function Qe(e){return e.map(t=>({id:t.id,cells:t.cells.map(r=>({value:r}))}))}function We(e){return e.map(t=>({id:t.id,cells:t.cells.map(r=>r.value)}))}const Oe=T({__name:"PriceRenderer",props:{modelValue:{},width:{}},setup(e){const t=e,r=f(()=>he(t.modelValue));return(a,n)=>(c(),m("span",{class:"price-renderer",style:B({width:e.width||"2vw"})},w(r.value),5))}}),Se=I(Oe,[["__scopeId","data-v-2b15d027"]]),_e=T({__name:"CheckboxRenderer",props:{modelValue:{},focused:{type:Boolean},width:{},readonly:{type:Boolean}},emits:["update:modelValue","blur","navigate"],setup(e,{emit:t}){const r=e,a=t,{onKeydown:n}=xe(a);function l(i){switch(i.key){case" ":i.preventDefault(),a("update:modelValue",!r.modelValue);return;case"Enter":i.preventDefault(),a("update:modelValue",!r.modelValue),a("navigate",b.Down);return}n(i)}const d=oe(null);return se(()=>r.focused,async i=>{i&&(await ie(),d.value?.$el?.querySelector('input[type="checkbox"]')?.focus())}),(i,u)=>{const S=O("v-checkbox");return c(),C(S,{ref_key:"checkboxRef",ref:d,"model-value":!!e.modelValue,"onUpdate:modelValue":u[0]||(u[0]=_=>i.$emit("update:modelValue",_)),density:"compact","hide-details":"",tabindex:"0",onKeydown:l,style:B({width:e.width||"1vw"}),readonly:e.readonly},null,8,["model-value","style","readonly"])}}}),ke={text:Ce,price:Se,checkbox:_e},Pe={key:0},Ve={key:1},ze={key:0},De={key:1},Re=T({__name:"BaseTable",props:{modelValue:{},tableColumns:{},hideRowIndex:{type:Boolean}},setup(e){function t(r,a,n){return a.calculate?a.calculate(r):n}return(r,a)=>{const n=O("v-table");return e.tableColumns.length>0?(c(),C(n,{key:0,class:"base-table",density:"compact",striped:"even"},{default:L(()=>[k("thead",null,[k("tr",null,[e.hideRowIndex!==!0?(c(),m("th",Pe,"#")):h("",!0),(c(!0),m(V,null,P(e.tableColumns,(l,d)=>(c(),m("th",{key:d},w(l.title),1))),128)),r.$slots.actions?(c(),m("th",Ve)):h("",!0)])]),k("tbody",null,[(c(!0),m(V,null,P(e.modelValue,(l,d)=>(c(),m("tr",{key:d},[e.hideRowIndex!==!0?(c(),m("td",ze,w(d+1),1)):h("",!0),(c(!0),m(V,null,P(l.cells,(i,u)=>A(r.$slots,"cell",{key:u,row:l,column:e.tableColumns[u],cell:i,rowIndex:d,colIndex:u},()=>[e.tableColumns[u].rendererType?(c(),m("td",{key:u},[(c(),C(le(v(ke)[e.tableColumns[u].rendererType]),{"model-value":t(l,e.tableColumns[u],i.value),width:e.tableColumns[u].width,readonly:!0},null,8,["model-value","width"]))])):h("",!0)],!0)),128)),r.$slots.actions?(c(),m("td",De,[A(r.$slots,"actions",{row:l,rowIndex:d},void 0,!0)])):h("",!0)]))),128))])]),_:3})):h("",!0)}}}),Xe=I(Re,[["__scopeId","data-v-e3b8abb4"]]),Le={name:"productCode",title:"Κωδικός Προϊόντος",type:"productCode",editorType:"text",rendererType:"text",navigable:!0,width:"2vw"},Be={name:"colour",title:"Χρώμα",type:"variation",editorType:"autocomplete",rendererType:"text",navigable:!0,width:"2.5vw",list:["WILD","F","GLOW","BL","ΚΦ","ΒΕΡ. ΝΑΠΑ","ΣΑ.ΤΖΙΝ","ΣΑ","ΚΝΛ","ΨΗΦ","OL","X","XK","ΤΑΜΠΑ.ΨΑΘΑ","ΓΚΡΙ","ΜΝΤ","ΚΙΤ.ΤΖΙΝ","ΚΦ.ΝΑΙΡ","CAM","LIM.ΚΡ","ROSE.ΚΡ","Χ.ΝΑΠΑ","ΤΑΜΠΑ.ΚΡ","OL.ΚΡ","ΚΥΡ.ΝΑΙΡ","Μ","ΓΚΡΙ.ΝΑΙΡ","ΓΚΡΙ.ΚΡ"]},Ie={name:"sole",title:"Σόλα",type:"variation",editorType:"autocomplete",rendererType:"text",navigable:!0,width:"2.5vw",list:["anatomic","soft","SOFT","vamos","VAMOS","fiesta","FIESTA","sand","SAND","momo","MOMO","esp"]},Ne={name:"men",title:"Men",type:"flag",rendererType:"checkbox",navigable:!0,width:"1vw"},x=[{name:"shoe:35",title:"35",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:36",title:"36",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:37",title:"37",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:38",title:"38",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:39",title:"39",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:40",title:"40",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:41",title:"41",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:42",title:"42",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:43",title:"43",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:44",title:"44",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:45",title:"45",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:46",title:"46",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"},{name:"shoe:47",title:"47",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1vw"}],j=[{order:0,...Le},{order:1,...Be},{order:2,...Ie},{order:3,...Ne},...x.map((e,t)=>({order:t+4,...e})),{order:x.length+4,title:"Τεμάχια Παραλλαγής",name:"calculated:totalQty",type:"calculated",rendererType:"text",width:"2vw",calculate:G},{order:x.length+5,title:"Τιμή Παραλλαγής",name:"variationPrice",type:"price",editorType:"price",rendererType:"price",navigable:!0,width:"2.5vw"},{order:x.length+6,title:"Σύνολο Παραλλαγής",name:"calculated:totalPrice",type:"calculated",rendererType:"price",width:"3vw",calculate:$e}].sort((e,t)=>e.order-t.order);function G(e){let t=0;return j.forEach((r,a)=>{r.type==="size"&&(t+=Number(e.cells[a].value)||0)}),t.toString()}function $e(e){const t=Number(G(e))||0,r=j.findIndex(n=>n.name==="variationPrice");if(r===-1)return"";const a=Number(e.cells[r].value)||0;return(t*a).toString()}function Je(e){const t=e.filter(o=>o.type==="variation"),r=e.filter(o=>o.type==="flag"),a=e.filter(o=>o.type==="size"),n=e.find(o=>o.type==="price"),l=e.find(o=>o.type==="productCode");function d(o){return o.map(s=>({cells:e.map(y=>a.includes(y)?Fe(s.sizing,y.name):y===n?Y(s.unitPrice):y===l?s.productCode:i(s.variationSnapshot,y))}))}function i(o,s){return s.type==="flag"?o.flags?.[s.name]?"true":"":o.attributes?.[s.name]||""}function u(o){return o.map(s=>{const y={attributes:S(s),flags:_(s)},N=Q(s),J=W(s),Z=X(s);return{unitPrice:J,productCode:N,variationSnapshot:y,sizing:Z,derivedSku:ce(N,y)}})}function S(o){return Object.fromEntries(t.map(s=>[s.name,o.cells[s.order]]))}function _(o){return Object.fromEntries(r.filter(s=>!!o.cells[s.order]).map(s=>[s.name,!0]))}function Q(o){return o.cells[e.indexOf(l)]?o.cells[e.indexOf(l)]:""}function W(o){return o.cells[e.indexOf(n)]?q(o.cells[e.indexOf(n)]):0}function X(o){return Object.fromEntries(a.map(s=>[s.name,q(o.cells[s.order])]))}return{vmToRows:d,rowsToVm:u}}function Fe(e,t){const r=Me(e,t);return Y(r)}function Me(e,t){const r=e[t];return r||0}function q(e){return e&&e!==""?Number(e):0}function Y(e){return e>0?e.toString():""}export{Xe as B,b as N,Ce as T,Ye as _,Ge as a,xe as b,Ke as c,Qe as d,Je as e,He as f,E as g,je as h,qe as i,Ue as j,U as n,ke as r,j as s,We as t,Ee as u};
