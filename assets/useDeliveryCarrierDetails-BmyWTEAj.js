import{O as n,Q as o,R as c,T as i,U as d,V as u,W as s,X as y,Y as C,C as p,P as l,Z as w,$ as S}from"./index-5v3h8jPH.js";class m{static async getNext(){const e=await n.getAll();if(e.length===0)return 1;const r=e.sort((a,h)=>a.clientNumber-h.clientNumber).map(a=>a.clientNumber).at(-1);if(!r)throw new Error("Could not find last client number");return r+1}}class P{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await m.getNext(),a=c(e.contactName,r,e.activity,e.businessName);return e.email&&e.email.trim()!==""&&a.addEmail(i(e.email,!0)),e.phone&&e.phone.trim()!==""&&a.addPhone(d(e.phone,!0)),e.address&&a.addAddress(u(e.address.street,e.address.city,e.address.zip,e.address.country,!0)),await n.add(a),this._partnersStore.add(s.toDTO(a)),a}}class I{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await m.getNext(),a=y(e.contactName,r,e.deliveryCarrierId,e.businessName);return e.email&&e.email.trim()!=""&&a.addEmail(i(e.email,!0)),e.phone&&e.phone.trim()!=""&&a.addPhone(d(e.phone,!0)),e.address&&a.addAddress(u(e.address.street,e.address.city,e.address.zip,e.address.country,!0)),await n.add(a),this._partnersStore.add(s.toDTO(a)),a}}class f{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getById(e.id);if(r)return r.updateData(e.contactName,e.businessName),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class B{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getSupplierById(e.id);if(r)return r.updateData(e.contactName,e.businessName,e.activity),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class H{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getB2BCustomerById(e.id);if(r)return r.updateData(e.contactName,e.businessName),r.deliveryCarrierId=e.deliveryCarrierId,await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class _{constructor(e=o()){this._partnersStore=e}async handle(e){await n.remove(e.id),this._partnersStore.remove(e.id)}}class v{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getById(e.partnerId);if(!r)return;const a=i(e.email,e.isPrimary,e.name);return r.addEmail(a),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class b{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getById(e.partnerId);if(!r)return;const a=i(e.email,e.isPrimary,e.name);return r.editEmail(e.emailId,a),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class g{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getById(e.partnerId);if(r)return r.removeEmail(e.emailId),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class D{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getById(e.partnerId);if(!r)return;const a=d(e.phone,e.isPrimary,e.name);return r.addPhone(a),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class E{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getById(e.partnerId);if(!r)return;const a=d(e.phone,e.isPrimary,e.name);return r.editPhone(e.phoneId,a),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class N{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getById(e.partnerId);if(r)return r.removePhone(e.phoneId),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class T{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getById(e.partnerId);if(!r)return;const a=u(e.street,e.city,e.zip,e.country,e.isPrimary,e.name);return r.addAddress(a),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class A{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getById(e.partnerId);if(!r)return;const a=u(e.street,e.city,e.zip,e.country,e.isPrimary,e.name);return r.editAddress(e.addressId,a),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}class O{constructor(e=o()){this._partnersStore=e}async handle(e){const r=await n.getById(e.partnerId);if(r)return r.removeAddress(e.addressId),await n.update(r),this._partnersStore.update(s.toDTO(r)),r}}function R(){const t=o(),{all:e}=C(t);return{b2bCustomers:p(()=>e.value.filter(r=>r.type===l.B2BCustomer).map(s.toModel)),suppliers:p(()=>e.value.filter(r=>r.type===l.Supplier).map(s.toModel)),createSupplierCommandHandler:new P(t),createB2BCustomerCommandHandler:new I(t),editSupplierCommandHandler:new B(t),editB2BCustomerCommandHandler:new H(t),editPartnerCommandHandler:new f(t),addEmailCommandHandler:new v(t),editEmailCommandHandler:new b(t),removeEmailCommandHandler:new g(t),addPhoneCommandHandler:new D(t),editPhoneCommandHandler:new E(t),removePhoneCommandHandler:new N(t),addAddressCommandHandler:new T(t),editAddressCommandHandler:new A(t),removeAddressCommandHandler:new O(t),deletePartnerCommandHandler:new _(t)}}function x(t){const r=w().getById(t);if(r)return S.toModel(r)}function z(t){const e=o();return{b2bCustomers:p(()=>e.getByType(l.B2BCustomer).filter(a=>a.deliveryCarrierId===t).map(s.toModel))}}export{z as a,x as g,R as u};
