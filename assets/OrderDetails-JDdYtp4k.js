import{_ as M}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-BQDfpqqg.js";import{u as H,a as q,_ as F,g as $,f as C,c as E,B as P,d as Q,s as A,e as N,h as J}from"./useVariationTableMapper-Ckq-1-8-.js";import{d as V,g as j,C as D,c as w,e as o,l,q as t,B as r,z as s,x,y as p,u as a,a8 as I,J as R,F as K,o as c,_ as U,m as g,a6 as G,r as W,I as X}from"./index-DDCoslFA.js";import{g as Y}from"./usePartnerDetails-C2FHGmbF.js";const Z={class:"text-h4 font-weight-bold mr-2"},ee={key:0,class:"text-subtitle-1 text-grey-darken-1 order-details-line"},te={key:0},oe={key:1},ne={key:1,class:"text-subtitle-1 text-grey-darken-1 order-details-line"},se={class:"text-subtitle-1 text-grey-darken-1 font-weight-bold order-details-line"},ae={class:"text-h5 font-weight-bold"},re={key:0},le=V({__name:"OrderDetailsHeader",props:{order:{}},setup(e){const{tCap:n}=j(),i=K(),{deleteOrderCommmandHandler:f}=H(),d=e,m=D(()=>Y(d.order.partnerId));function u(){return`${n("order.order")} #${d.order.orderNumber}`}function h(){i.back(),f.handle({id:d.order.id})}return(z,y)=>{const v=l("v-col"),_=l("v-row"),b=l("v-btn");return c(),w(R,null,[o(_,{align:"start",justify:"space-between",dense:""},{default:t(()=>[o(v,{cols:"5",class:"d-flex",justify:"start"},{default:t(()=>[r("h1",Z,s(u()),1),o(q,{status:e.order.status,class:"ml-2"},null,8,["status"]),o(F,{direction:e.order.direction,class:"ml-2"},null,8,["direction"])]),_:1}),o(v,{cols:"4",class:"d-flex flex-row justify-end"}),o(v,{cols:"1",class:"d-flex flex-row justify-end"},{default:t(()=>[o(M,{name:u(),"action-fn":()=>h(),mini:""},null,8,["name","action-fn"])]),_:1})]),_:1}),o(_,{align:"start",justify:"space-between",dense:""},{default:t(()=>[o(v,{cols:"3",class:"text-md-left"},{default:t(()=>[m.value?(c(),w("div",ee,[e.order.direction===a(I).Credit?(c(),w("strong",te,s(a(n)("partner.customer")),1)):x("",!0),e.order.direction===a(I).Debit?(c(),w("strong",oe,s(a(n)("partner.customer")),1)):x("",!0),y[0]||(y[0]=p(": ",-1)),o(b,{variant:"text",to:`/partner/${m.value.id}`},{default:t(()=>[p(s(m.value.businessName),1)]),_:1},8,["to"])])):x("",!0),e.order.dueDate?(c(),w("div",ne,[r("strong",null,s(a(n)("order.dueDate")),1),p(": "+s(a($)(e.order.dueDate)),1)])):x("",!0),r("div",se,s(a(n)("order.notes"))+": ",1),r("span",null,s(e.order.notes),1)]),_:1}),o(v,{cols:"4",md:"5",class:"text-md-right"},{default:t(()=>[r("span",null,s(a(n)("order.total")),1),r("div",ae,s(a(C)(e.order.totalAmount)),1),r("div",null,[p(s(a(n)("order.orderSum"))+" ",1),r("strong",null,s(a(C)(e.order.subtotal)),1),p(" · "+s(a(n)("order.vatRate"))+" ",1),r("strong",null,s(a(C)(e.order.taxAmount)),1),e.order.discountAmount>0?(c(),w("span",re,[p(" · "+s(a(n)("order.discount"))+" ",1),r("strong",null,s(a(C)(e.order.discountAmount)),1)])):x("",!0)])]),_:1})]),_:1})],64)}}}),ie=U(le,[["__scopeId","data-v-b3c0cc9f"]]),de=V({__name:"DisplayTable",props:{tableRows:{},tableColumns:{},hideRowIndex:{type:Boolean}},setup(e){const n=e,i=D(()=>E(n.tableRows));return(f,d)=>(c(),g(P,{modelValue:i.value,"table-columns":e.tableColumns,"hide-row-index":e.hideRowIndex},null,8,["modelValue","table-columns","hide-row-index"]))}});function ce(e){return{id:e.id,name:e.name,variations:ue([...e.variations])}}function ue(e){const n=e.map(me);return _e(n)}function _e(e){const n=new Map;for(const i of e){const f=i.normalizedAttributes,d=n.get(f);if(d)for(const[m,u]of Object.entries(i.sizing))d.sizing[m]=(d.sizing[m]||0)+u;else n.set(f,{...i,sizing:{...i.sizing}})}return[...n.values()]}function me(e){const{size:n,...i}=e.attributes;return{attributes:ve(i),sizing:pe(n,e.quantity),price:e.price,normalizedAttributes:G(i)}}function ve(e){return Object.fromEntries(Object.entries(e).map(([n,i])=>[n,i.toString()]))}function pe(e,n){return{[`shoe:${e}`]:n}}const fe=V({__name:"OrderDetailsLineItemDetails",props:{item:{}},setup(e){const{tCap:n}=j(),{regVmToRows:i}=Q(N),f=e,d=D(()=>ce(f.item)),m=D(()=>i(d.value.variations)),u=D(()=>{const v=d.value.variations.reduce((_,b)=>{const k=Object.values(b.attributes).filter(O=>O).join(" ");return _?_+", "+k:k},"");return v?`(${v})`:""}),h=D(()=>d.value.variations.length),z=D(()=>d.value.variations.reduce((v,_)=>v+A(_),0)),y=D(()=>d.value.variations.reduce((v,_)=>v+A(_)*_.price,0));return(v,_)=>{const b=l("v-col"),k=l("v-spacer"),O=l("v-row"),T=l("v-fade-transition"),B=l("v-expansion-panel-title"),L=l("v-expansion-panel-text"),S=l("v-expansion-panel");return c(),g(S,null,{default:t(()=>[o(B,{"hide-actions":""},{default:t(({expanded:Ce})=>[o(O,{"no-gutters":""},{default:t(()=>[o(b,{class:"d-flex justify-start",cols:"4"},{default:t(()=>[p(s(d.value.name||"no name")+" "+s(u.value),1)]),_:1}),o(b,{class:"text--secondary",cols:"8"},{default:t(()=>[o(T,{"leave-absolute":""},{default:t(()=>[o(O,{style:{width:"100%"},"no-gutters":""},{default:t(()=>[o(k),o(b,{cols:"3"},{default:t(()=>[p(s(a(n)("order.variation",2))+": ",1),r("strong",null,s(h.value),1)]),_:1}),o(b,{cols:"3"},{default:t(()=>[p(s(a(n)("order.productQuantity"))+": ",1),r("strong",null,s(z.value),1)]),_:1}),o(b,{cols:"3"},{default:t(()=>[p(s(a(n)("order.productSum"))+": ",1),r("strong",null,s(y.value.toFixed(2))+"€",1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(L,null,{default:t(()=>[o(de,{tableRows:m.value,"table-columns":a(N)},null,8,["tableRows","table-columns"])]),_:1})]),_:1})}}}),xe=V({__name:"OrderDetailsLineItems",props:{order:{}},setup(e){const{tCap:n}=j(),i=W([]);return(f,d)=>{const m=l("v-chip"),u=l("v-list-item"),h=l("v-card-title"),z=l("v-expansion-panels"),y=l("v-card-text"),v=l("v-card");return c(),g(v,null,{default:t(()=>[o(h,null,{default:t(()=>[o(u,null,{title:t(()=>[r("h3",null,s(a(n)("order.items",2)),1)]),append:t(()=>[o(m,{size:"small"},{default:t(()=>[p(s(e.order.items.length),1)]),_:1})]),_:1})]),_:1}),o(y,null,{default:t(()=>[o(z,{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=_=>i.value=_),multiple:""},{default:t(()=>[(c(!0),w(R,null,X(e.order.items,_=>(c(),g(fe,{key:_.id,item:_},null,8,["item"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),ge={class:"d-flex"},he={class:"me-4"},be={class:"d-flex"},ye={class:"me-4"},De={class:"d-flex"},we={class:"me-4"},ze={class:"d-flex"},$e={class:"me-4"},Ve={class:"d-flex"},ke={class:"me-4"},Oe=V({__name:"OrderDetailsTimeline",props:{order:{}},setup(e){const{tCap:n}=j();return(i,f)=>{const d=l("v-card-title"),m=l("v-divider"),u=l("v-timeline-item"),h=l("v-timeline"),z=l("v-card-text"),y=l("v-card");return c(),g(y,null,{default:t(()=>[o(d,null,{default:t(()=>[p(s(a(n)("common.timeline")),1)]),_:1}),o(m),o(z,null,{default:t(()=>[o(h,{align:"start",side:"end"},{default:t(()=>[o(u,{"dot-color":"indigo",size:"small"},{opposite:t(()=>[r("div",null,s(a(n)("order.createdDate")),1)]),default:t(()=>[r("div",ge,[r("strong",he,s(a($)(e.order.createdDate)),1)])]),_:1}),e.order.approvedDate?(c(),g(u,{key:0,"dot-color":"indigo",size:"small"},{opposite:t(()=>[r("div",null,s(a(n)("order.approvedDate")),1)]),default:t(()=>[r("div",be,[r("strong",ye,s(a($)(e.order.approvedDate)),1)])]),_:1})):x("",!0),e.order.shippedDate?(c(),g(u,{key:1,"dot-color":"indigo",size:"small"},{opposite:t(()=>[r("div",null,s(a(n)("order.shippedDate")),1)]),default:t(()=>[r("div",De,[r("strong",we,s(a($)(e.order.shippedDate)),1)])]),_:1})):x("",!0),e.order.completedDate?(c(),g(u,{key:2,"dot-color":"grey",size:"small"},{opposite:t(()=>[r("div",null,s(a(n)("order.completedDate")),1)]),default:t(()=>[r("div",ze,[r("strong",$e,s(a($)(e.order.completedDate)),1)])]),_:1})):x("",!0),e.order.cancelledDate?(c(),g(u,{key:3,"dot-color":"red",size:"small"},{opposite:t(()=>[r("div",null,s(a(n)("order.cancelledDate")),1)]),default:t(()=>[r("div",Ve,[r("strong",ke,s(a($)(e.order.cancelledDate)),1)])]),_:1})):x("",!0)]),_:1})]),_:1})]),_:1})}}}),Re=V({__name:"OrderDetails",props:{id:{}},setup(e){const n=e,{model:i}=J(n.id);return(f,d)=>{const m=l("v-col"),u=l("v-row"),h=l("v-container");return a(i)?(c(),g(h,{key:0},{default:t(()=>[o(ie,{order:a(i)},null,8,["order"]),o(u,{class:"mt-6",align:"start"},{default:t(()=>[o(m,{cols:"12",md:"8",xl:"10"},{default:t(()=>[o(xe,{order:a(i)},null,8,["order"])]),_:1}),o(m,{cols:"12",md:"4",xl:"2"},{default:t(()=>[o(Oe,{order:a(i)},null,8,["order"])]),_:1})]),_:1})]),_:1})):x("",!0)}}});export{Re as default};
