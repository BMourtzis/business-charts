import{g as Z,C as $,d as U,G as Ue,m as R,l as p,u as s,q as m,e as l,x as M,H as ee,y as B,z as C,F as De,o as w,c as q,a2 as H,_ as J,a3 as ce,r as K,w as P,n as ye,B as z,I as oe,J as le,a4 as Oe,a5 as pe,f as ie,t as ue,a6 as Ne,A as ge,j as Be,k as Ie,p as ve,a7 as Se}from"./index-5v3h8jPH.js";import{_ as qe}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-D9zwxli9.js";import{g as je,a as Le,u as se}from"./useOrderDetails-CDTlUd1r.js";import{g as Ke}from"./usePartnerDetails-DalGRZ2O.js";function Fe(e,n){return{id:e.id,orderNumber:Me(e.orderNumber),partner:Ke(e.partnerId),createdDate:fe(e.createdDate),dueDate:fe(e.dueDate),status:Le(e.status,n),direction:je(e.direction,n),total:Pe(e.totalAmount)}}function Me(e){return`#${e}`}function fe(e){return e?e.toLocaleDateString():"-"}function Pe(e){return`${e.toFixed(2)}€`}function Qe(e){return[{title:e("order.number"),key:"orderNumber",align:"start"},{title:e("partner.businessName"),key:"partner",align:"start"},{title:e("order.createdDate"),key:"createdDate",align:"start"},{title:e("order.dueDate"),key:"dueDate",align:"start"},{title:e("order.status"),key:"status",align:"start"},{title:e("order.direction"),key:"direction",align:"start"},{title:e("order.total"),key:"total",align:"start"},{title:e("common.action",2),key:"actions",align:"start"}]}function He(e){const{tCap:n}=Z(),t=$(()=>(e.value??[]).map(u=>Fe(u,n))),i=$(()=>Qe(n));return{data:t,headers:i}}const We=U({__name:"OrderList",props:{orders:{}},setup(e){const n=De(),t=e,{deleteOrderCommmandHandler:i}=se(),{data:a,headers:u}=He(Ue(t,"orders"));function r(d){return d.partner?`παραγγελία για ${c(d.partner)}`:d.id}function c(d){return d.businessName?`${d.businessName} (${d.contactName})`:d.contactName}function o(d,v){n.push(`/order/${v.item.id}`)}return(d,v)=>{const f=p("v-btn"),b=p("v-data-table");return w(),R(b,{headers:s(u),items:s(a),class:"text-start","hide-default-footer":"",density:"comfortable",hover:"","onClick:row":o},{"item.partner":m(({item:_})=>[_.partner!==void 0?(w(),R(f,{key:0,variant:"text",onClick:ee(()=>s(n).push(`/partner/${_.partner?.id}`),["stop"])},{default:m(()=>[B(C(c(_.partner)),1)]),_:2},1032,["onClick"])):M("",!0)]),"item.actions":m(({item:_})=>[l(qe,{name:r(_),"action-fn":()=>s(i).handle({id:_.id}),mini:!0},null,8,["name","action-fn"])]),_:2},1032,["headers","items"])}}}),Ge=U({__name:"TextRenderer",props:{modelValue:{},width:{}},setup(e){return(n,t)=>(w(),q("span",{class:"text-renderer",style:H({width:e.width||"1vw"})},C(e.modelValue),5))}}),we=J(Ge,[["__scopeId","data-v-1a107f6e"]]);var L=(e=>(e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right",e))(L||{});function te(e,n={}){const{allowArrowNavigation:t=!0}=n;function i(a){let u=null;switch(a.key){case"Enter":u=a.shiftKey?L.Up:L.Down;break;case"Tab":u=a.shiftKey?L.Left:L.Right;break}u!==null&&(a.preventDefault(),e("navigate",u))}return{onKeydown:i}}const Ve=U({__name:"TextEditor",props:{modelValue:{},width:{}},emits:["update:modelValue","blur","navigate"],setup(e,{emit:n}){const t=n,{onKeydown:i}=te(t);return(a,u)=>{const r=p("v-text-field");return w(),R(r,{"model-value":e.modelValue,"onUpdate:modelValue":u[0]||(u[0]=c=>a.$emit("update:modelValue",c)),density:"compact",variant:"underlined","hide-details":"",autofocus:"",onBlur:u[1]||(u[1]=c=>a.$emit("blur")),onKeydown:s(i),style:H({width:e.width||"1vw"})},null,8,["model-value","onKeydown","style"])}}}),Xe=U({__name:"EditableCell",props:{modelValue:{},focused:{type:Boolean},hasEditor:{type:Boolean},width:{}},emits:["update:modelValue","request-edit","request-close","request-move-cell","request-move-row"],setup(e,{emit:n}){const t=e,i=n,a=$({get:()=>t.modelValue,set:b=>u(b)});function u(b){i("update:modelValue",b)}function r(){!t.focused&&t.hasEditor&&i("request-edit")}function c(b,_){return _?b:!1}function o(b){switch(b){case L.Up:v(-1);break;case L.Down:v(1);break;case L.Left:d(-1);break;case L.Right:d(1);break}}function d(b){i("request-move-cell",b)}function v(b){i("request-move-row",b)}function f(b){b?.preventDefault(),i("request-close")}return(b,_)=>(w(),q("td",{onClick:ee(r,["stop"])},[c(e.focused,e.hasEditor)?ce(b.$slots,"editor",{key:0,value:a.value,width:e.width,onUpdate:u,onBlur:f,onNavigate:o,onKeydown:_[0]||(_[0]=ee(()=>{},["stop"]))},()=>[l(Ve,{"model-value":a.value,width:e.width,"onUpdate:modelValue":u,onBlur:f,onNavigate:o},null,8,["model-value","width"])]):M("",!0),c(e.focused,e.hasEditor)?M("",!0):ce(b.$slots,"display",{key:1,value:a.value,width:e.width,focused:e.focused,onUpdate:u,onBlur:f,onNavigate:o,onKeydown:_[1]||(_[1]=ee(()=>{},["stop"]))},()=>[l(we,{modelValue:a.value,width:e.width},null,8,["modelValue","width"])])]))}});function Ze(e){return e.map(n=>({id:n.id,cells:n.cells.map(t=>({value:t}))}))}function Je(e){return e.map(n=>({id:n.id,cells:n.cells.map(t=>t.value)}))}function Ye(e,n,t){function i(y){return y.row*n.length+y.column}const a=K(null);function u(y,E){a.value=i({row:y,column:E})}function r(){a.value=null,t()}function c(y){a.value!==null&&d(a.value,y)}function o(y){a.value!==null&&d(a.value,A(y))}function d(y,E){let D=y+E;const O=v(E);for(;_(D);){if(f(D)){a.value=D,t();return}D+=O}}function v(y){return y<0?-1:1}function f(y){return b(y)?.navigable}function b(y){const E=y%n.length;return n.find(D=>D.order===E)}function _(y){return!(y<0||y>=e.value.length*n.length)}function A(y){return y*n.length}function I(y,E){return A(y)+E===a.value}return{startEditingCell:u,isCellFocused:I,stopEditingCell:r,moveEditingCellByCell:c,moveEditingCellByRow:o}}const et=U({__name:"AutocompleteEditor",props:{modelValue:{},items:{},width:{}},emits:["update:modelValue","blur","navigate"],setup(e,{emit:n}){const t=n,{onKeydown:i}=te(t);return(a,u)=>{const r=p("v-autocomplete");return w(),R(r,{class:"autocomplete-editor","model-value":e.modelValue,"onUpdate:modelValue":u[0]||(u[0]=c=>a.$emit("update:modelValue",c)),items:e.items,density:"compact","hide-details":"",autofocus:"",onBlur:u[1]||(u[1]=c=>a.$emit("blur")),onKeydown:s(i),style:H({width:e.width||"5vw"})},null,8,["model-value","items","onKeydown","style"])}}}),tt=J(et,[["__scopeId","data-v-85bbdfb4"]]),nt=U({__name:"NumberEditor",props:{modelValue:{},width:{}},emits:["update:modelValue","blur","navigate"],setup(e,{emit:n}){const t=n,{onKeydown:i}=te(t);return(a,u)=>{const r=p("v-text-field");return w(),R(r,{class:"number-editor","model-value":e.modelValue,"onUpdate:modelValue":u[0]||(u[0]=c=>a.$emit("update:modelValue",c)),density:"compact",variant:"underlined","hide-details":"",autofocus:"",type:"text",inputmode:"numeric",pattern:"[0-9]*",onBlur:u[1]||(u[1]=c=>a.$emit("blur")),onKeydown:s(i),style:H({width:e.width||"1vw"})},null,8,["model-value","onKeydown","style"])}}}),ot=U({__name:"PriceEditor",props:{modelValue:{},width:{}},emits:["update:modelValue","blur","navigate"],setup(e,{emit:n}){const t=n,{onKeydown:i}=te(t);function a(u){const r=u.replace(/[^\d.]/g,"").split(".");return r.length>2?r.shift()+"."+r.join(""):r.join(".")}return(u,r)=>{const c=p("v-text-field");return w(),R(c,{class:"price-editor","model-value":e.modelValue,"onUpdate:modelValue":r[0]||(r[0]=o=>u.$emit("update:modelValue",a(o))),density:"compact",variant:"underlined","hide-details":"",autofocus:"",type:"text",inputmode:"decimal",onBlur:r[1]||(r[1]=o=>u.$emit("blur")),onKeydown:s(i),suffix:"€",style:H({width:e.width||"2vw"})},null,8,["model-value","onKeydown","style"])}}}),lt={autocomplete:tt,number:nt,price:ot,text:Ve},at=U({__name:"PriceRenderer",props:{modelValue:{},width:{}},setup(e){const n=e,t=$(()=>{const i=parseFloat(n.modelValue);return isNaN(i)?"0.00 €":`${i.toFixed(2)} €`});return(i,a)=>(w(),q("span",{class:"price-renderer",style:H({width:e.width||"2vw"})},C(t.value),5))}}),rt=J(at,[["__scopeId","data-v-543ebf0b"]]),ut=U({__name:"CheckboxRenderer",props:{modelValue:{},focused:{type:Boolean},width:{}},emits:["update:modelValue","blur","navigate"],setup(e,{emit:n}){const t=e,i=n,{onKeydown:a}=te(i);function u(c){switch(c.key){case" ":c.preventDefault(),i("update:modelValue",!t.modelValue);return;case"Enter":c.preventDefault(),i("update:modelValue",!t.modelValue),i("navigate",L.Down);return}a(c)}const r=K(null);return P(()=>t.focused,async c=>{c&&(await ye(),r.value?.$el?.querySelector('input[type="checkbox"]')?.focus())}),(c,o)=>{const d=p("v-checkbox");return w(),R(d,{ref_key:"checkboxRef",ref:r,"model-value":e.modelValue,"onUpdate:modelValue":o[0]||(o[0]=v=>c.$emit("update:modelValue",v)),density:"compact","hide-details":"",tabindex:"0",onKeydown:u,style:H({width:e.width||"1vw"})},null,8,["model-value","style"])}}}),it={text:we,price:rt,checkbox:ut},st={key:0},dt={key:0},mt=U({__name:"EditableTable",props:{modelValue:{},tableColumns:{},hideRowIndex:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:n}){const t=e,i=n,a=K([]),{startEditingCell:u,isCellFocused:r,stopEditingCell:c,moveEditingCellByCell:o,moveEditingCellByRow:d}=Ye(a,t.tableColumns,f);P(()=>t.modelValue,A=>{a.value=Ze(A)},{immediate:!0,deep:!0});function v(A,I,y){return I.calculate?I.calculate(A):y}function f(){i("update:modelValue",Je(a.value))}function b(A){return t.tableColumns[A].editorType!==void 0}function _(A){c(),a.value.splice(A,1),f()}return(A,I)=>{const y=p("v-btn"),E=p("v-table");return e.tableColumns.length>0?(w(),R(E,{key:0,class:"editable-table",density:"compact",striped:"even"},{default:m(()=>[z("thead",null,[z("tr",null,[e.hideRowIndex!==!0?(w(),q("th",st,"#")):M("",!0),(w(!0),q(le,null,oe(e.tableColumns,(D,O)=>(w(),q("th",{key:O},C(D.title),1))),128)),I[0]||(I[0]=z("th",null,null,-1))])]),z("tbody",null,[(w(!0),q(le,null,oe(a.value,(D,O)=>(w(),q("tr",{key:O},[e.hideRowIndex!==!0?(w(),q("td",dt,C(O+1),1)):M("",!0),(w(!0),q(le,null,oe(D.cells,(x,V)=>(w(),R(Xe,{key:V,modelValue:x.value,"onUpdate:modelValue":g=>x.value=g,focused:s(r)(O,V),hasEditor:b(V),width:e.tableColumns[V].width,onRequestEdit:g=>s(u)(O,V),onRequestClose:s(c),onRequestMoveCell:s(o),onRequestMoveRow:s(d)},Oe({_:2},[e.tableColumns[V].editorType?{name:"editor",fn:m(g=>[(w(),R(pe(s(lt)[e.tableColumns[V].editorType]),{"model-value":g.value,"onUpdate:modelValue":g.onUpdate,width:g.width,items:e.tableColumns[V].list,onBlur:g.onBlur,onNavigate:g.onNavigate},null,40,["model-value","onUpdate:modelValue","width","items","onBlur","onNavigate"]))]),key:"0"}:void 0,e.tableColumns[V].rendererType?{name:"display",fn:m(g=>[(w(),R(pe(s(it)[e.tableColumns[V].rendererType]),{"model-value":v(D,e.tableColumns[V],g.value),width:g.width,focused:g.focused,"onUpdate:modelValue":g.onUpdate,onBlur:g.onBlur,onNavigate:g.onNavigate},null,40,["model-value","width","focused","onUpdate:modelValue","onBlur","onNavigate"]))]),key:"1"}:void 0]),1032,["modelValue","onUpdate:modelValue","focused","hasEditor","width","onRequestEdit","onRequestClose","onRequestMoveCell","onRequestMoveRow"]))),128)),z("td",null,[l(y,{icon:"mdi-close",variant:"text",color:"error",onClick:x=>_(O)},null,8,["onClick"])])]))),128))])]),_:1})):M("",!0)}}}),ct=J(mt,[["__scopeId","data-v-d5041bbc"]]),pt={name:"colour",title:"Χρώμα",type:"variation",editorType:"autocomplete",rendererType:"text",navigable:!0,width:"4vw",list:["BLK","WILD","F","KIT.TZIN","GLOW","BL","ΚΦ","ΒΕΡ. ΝΑΠΑ","ΣΑ.ΤΖΙΝ","ΣΑ","ΚΝΛ","ΨΗΦ","OL","X","XK","ΤΑΜΠΑ.Ψ","ΓΚΡΙ","ΜΝΤ","ΚΙΤ.ΤΖΙΝ","ΚΦ.ΝΑΙΡ"]},vt={name:"sole",title:"Σόλα",type:"variation",editorType:"autocomplete",rendererType:"text",navigable:!0,width:"4vw",list:["anatomic","SOFT","soft","vamos","VAMOS","FIESTA","fiesta","SAND","sand"]},ft={name:"men",title:"Men",type:"variation",rendererType:"checkbox",navigable:!0,width:"1vw"},ne=[{name:"shoe:35",title:"35",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:36",title:"36",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:37",title:"37",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:38",title:"38",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:39",title:"39",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:40",title:"40",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:41",title:"41",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:42",title:"42",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:43",title:"43",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:44",title:"44",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:45",title:"45",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:46",title:"46",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"},{name:"shoe:47",title:"47",type:"size",editorType:"number",rendererType:"text",navigable:!0,width:"1.2vw"}],X=[{order:0,...pt},{order:1,...vt},{order:2,...ft},...ne.map((e,n)=>({order:n+3,...e})),{order:ne.length+3,title:"Τεμάχια Παραλλαγής",name:"calculated:totalQty",type:"calculated",rendererType:"text",width:"2vw",calculate:he},{order:ne.length+4,title:"Τιμή Παραλλαγής",name:"variationPrice",type:"price",editorType:"price",rendererType:"price",navigable:!0,width:"2.5vw"},{order:ne.length+5,title:"Σύνολο Παραλλαγής",name:"calculated:totalPrice",type:"calculated",rendererType:"price",width:"3vw",calculate:bt}].sort((e,n)=>e.order-n.order);function he(e){let n=0;return X.forEach((t,i)=>{t.type==="size"&&(n+=Number(e.cells[i].value)||0)}),n.toString()}function bt(e){const n=Number(he(e))||0,t=X.findIndex(a=>a.name==="variationPrice");if(t===-1)return"";const i=Number(e.cells[t].value)||0;return(n*i).toString()}function _t(e){const n=e.filter(d=>d.type==="variation"),t=e.filter(d=>d.type==="size"),i=e.find(d=>d.type==="price");function a(d){return d.map(v=>({cells:e.map(f=>t.includes(f)?o(v.sizing[f.name]):f===i?o(v.price):v.attributes[f.name]||"")}))}function u(d){return d.map(v=>({attributes:Object.fromEntries(n.map((f,b)=>[f.name,v.cells[b]])),sizing:Object.fromEntries(t.map((f,b)=>[f.name,c(v.cells[b+n.length])])),price:v.cells[e.indexOf(i)]?c(v.cells[e.indexOf(i)]):0}))}function r(d){return Object.values(d.sizing).reduce((v,f)=>v+f,0)}function c(d){return d&&d!==""?Number(d):0}function o(d){return d>0?d.toString():""}return{vmToRows:a,rowsToVm:u,sumSizing:r}}const yt=U({__name:"OrderItemEdit",props:{modelValue:{}},emits:["update:modelValue","remove-item"],setup(e,{emit:n}){const{tCap:t}=Z(),{maxLength:i,required:a,numeric:u}=ie(),r=e,c=n,o=K(structuredClone(ue(r.modelValue)));P(()=>r.modelValue,x=>{o.value=structuredClone(ue(x))},{deep:!0});function d(){c("update:modelValue",structuredClone(ue(o.value)))}const{vmToRows:v,rowsToVm:f,sumSizing:b}=_t(X),_=$({get:()=>v(o.value.variations),set:x=>{o.value.variations=f(x),d()}}),A=$(()=>{const x=o.value.variations.reduce((V,g)=>{const F=Object.values(g.attributes).filter(W=>W).join(" ");return V?V+", "+F:F},"");return x?`(${x})`:""}),I=$(()=>o.value.variations.length),y=$(()=>o.value.variations.reduce((x,V)=>x+b(V),0)),E=$(()=>o.value.variations.reduce((x,V)=>x+b(V)*V.price,0));function D(){o.value.variations.push({attributes:Object.fromEntries(X.slice(0,2).map(x=>[x.name,""])),sizing:Object.fromEntries(X.filter(x=>x.name.includes("shoe:")).map(x=>[x.name,0])),price:o.value.basePrice}),d()}function O(x){c("remove-item",o.value.id)}return(x,V)=>{const g=p("v-col"),F=p("v-spacer"),W=p("v-btn"),Y=p("v-row"),ae=p("v-fade-transition"),S=p("v-expansion-panel-title"),h=p("v-text-field"),N=p("v-expansion-panel-text"),Q=p("v-expansion-panel");return w(),R(Q,null,{default:m(()=>[l(S,{"hide-actions":""},{default:m(({expanded:T})=>[l(Y,{"no-gutters":""},{default:m(()=>[l(g,{class:"d-flex justify-start",cols:"4"},{default:m(()=>[B(C(o.value.name||"no name")+" "+C(A.value),1)]),_:1}),l(g,{class:"text--secondary",cols:"8"},{default:m(()=>[l(ae,{"leave-absolute":""},{default:m(()=>[l(Y,{style:{width:"100%"},"no-gutters":""},{default:m(()=>[l(F),l(g,{cols:"3"},{default:m(()=>[B(C(s(t)("order.variation",2))+": ",1),z("strong",null,C(I.value),1)]),_:1}),l(g,{cols:"3"},{default:m(()=>[B(C(s(t)("order.productQuantity"))+": ",1),z("strong",null,C(y.value),1)]),_:1}),l(g,{cols:"3"},{default:m(()=>[B(C(s(t)("order.productSum"))+": ",1),z("strong",null,C(E.value.toFixed(2))+"€",1)]),_:1}),l(g,{cols:"1"},{default:m(()=>[l(W,{size:"medium",icon:"mdi-trash-can",color:"error",variant:"text",onClick:V[0]||(V[0]=ee(G=>O(o.value.id),["stop"]))})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(N,null,{default:m(()=>[l(Y,{justify:"space-around","no-gutters":""},{default:m(()=>[l(g,{cols:"6"},{default:m(()=>[l(h,{modelValue:o.value.name,"onUpdate:modelValue":V[1]||(V[1]=T=>o.value.name=T),onBlur:d,label:s(t)("order.product"),rules:[s(a),s(i)(50)]},null,8,["modelValue","label","rules"])]),_:1}),l(g,{cols:"2"},{default:m(()=>[l(h,{modelValue:o.value.basePrice,"onUpdate:modelValue":V[2]||(V[2]=T=>o.value.basePrice=T),onBlur:d,label:s(t)("order.basePrice"),rules:[s(u)],type:"number",min:"0",step:"0.01",suffix:"€"},null,8,["modelValue","label","rules"])]),_:1}),l(g,{cols:"2"},{default:m(()=>[l(W,{color:"success",text:s(t)("order.addVariationTitle"),"prepend-icon":"mdi-plus",variant:"text",onClick:D},null,8,["text"])]),_:1})]),_:1}),_.value.length>0?(w(),R(ct,{key:0,modelValue:_.value,"onUpdate:modelValue":V[3]||(V[3]=T=>_.value=T),tableColumns:s(X)},null,8,["modelValue","tableColumns"])):M("",!0)]),_:1})]),_:1})}}}),gt=["shoe:38","shoe:39","shoe:40","shoe:41","shoe:42","shoe:43","shoe:44","shoe:45","shoe:46","shoe:47"];function wt(e){return{id:e.id,name:e.name,basePrice:e.variations?.[0]?.price||0,variations:e.variations.map(Vt)}}function Vt(e){const n={},t={};for(const[i,a]of Object.entries(e.attributes))gt.includes(i)?t[i]=Number(a)||0:n[i]=String(a);return Object.keys(t).length===0&&e.quantity>0,{attributes:n,sizing:t,price:e.price}}function be(e){return{partnerId:e.partnerId,vatRate:e.vatRate,dueDate:e.dueDate||void 0,notes:e.notes,depositAmount:e.depositAmount,discountAmount:e.discountAmount,items:ht(e.items)}}function ht(e){return e.map(n=>({name:n.name,variations:xt(n.variations)}))}function xt(e){const n=e.flatMap(t=>Tt(t));return Ct(n).sort((t,i)=>t.normalizedAttributes.localeCompare(i.normalizedAttributes))}function Ct(e){const n=new Map;for(const t of e){const i=t.normalizedAttributes,a=n.get(i);a?a.quantity+=t.quantity:n.set(i,{...t})}return[...n.values()]}function Tt(e,n){const t=kt(e.sizing),i=At(e.attributes);return t.map(([a,u])=>{const r={...i,size:a};return{attributes:r,normalizedAttributes:Ne(r),quantity:u,price:e.price}})}function kt(e){return Object.entries(e).filter(([n,t])=>t>0).map(([n,t])=>[n.split(":")[1],t])}function At(e,n){return{...$t(e)}}function $t(e){return Object.fromEntries(Object.entries(e).filter(([n,t])=>t!==""&&t!==null&&t!==void 0))}const _e=U({__name:"AmountAdjustmentField",props:{modelValue:{},baseAmount:{},label:{}},emits:["update:modelValue"],setup(e,{emit:n}){const t=e,i=n,a=K("percent"),u=K(0),r=$(()=>a.value==="amount"?u.value||0:((u.value||0)/100*t.baseAmount).toFixed(2)),c=$(()=>a.value==="percent"?`${r.value} €`:"");return P(()=>t.modelValue,o=>{a.value==="amount"?u.value=o:t.baseAmount>0&&(u.value=+(o/t.baseAmount*100).toFixed(2))},{immediate:!0}),P(()=>t.baseAmount,o=>{if(a.value==="percent"){const d=o*(u.value||0)/100;i("update:modelValue",Math.max(0,d))}}),P([u,a],()=>{let o=0;a.value==="amount"?o=u.value||0:o=(u.value||0)/100*t.baseAmount,i("update:modelValue",Math.max(0,o))}),(o,d)=>{const v=p("v-btn"),f=p("v-btn-toggle"),b=p("v-text-field");return w(),R(b,{modelValue:u.value,"onUpdate:modelValue":d[1]||(d[1]=_=>u.value=_),hint:c.value,label:e.label,type:"number","persistent-hint":a.value==="percent"},{"append-inner":m(()=>[l(f,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=_=>a.value=_),density:"compact",mandatory:"",divided:"","selected-class":"bg-primary"},{default:m(()=>[l(v,{value:"percent"},{default:m(()=>[...d[2]||(d[2]=[B("%",-1)])]),_:1}),l(v,{value:"amount"},{default:m(()=>[...d[3]||(d[3]=[B("€",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","hint","label","persistent-hint"])}}}),Rt=U({__name:"vatCalculatorField",props:{modelValue:{},baseAmount:{}},emits:["update:modelValue"],setup(e,{emit:n}){const{required:t,numeric:i}=ie(),{tCap:a}=Z(),u=e,r=n,c=K(0),o=f=>{c.value=Number(f)/100},d=$(()=>+(c.value*u.baseAmount).toFixed(2)),v=$(()=>`${d.value} €`);return P(()=>u.modelValue,f=>{c.value=Number(f)||0},{immediate:!0}),P(()=>c.value,f=>{r("update:modelValue",f)}),(f,b)=>{const _=p("v-text-field");return w(),R(_,{"model-value":c.value*100,"onUpdate:modelValue":o,type:"number",min:"0",max:"100",step:"1",suffix:"%",label:s(a)("order.vatRate"),rules:[s(t),s(i)],hint:v.value,"persistent-hint":""},null,8,["model-value","label","rules","hint"])}}}),zt={class:"date-picker-wrapper"},Et={class:"v-label"},Ut={class:"date-picker-row"},Dt=U({__name:"DatePicker",props:{modelValue:{},title:{}},emits:["update:modelValue"],setup(e,{emit:n}){const{tCap:t}=Z(),i=e,a=n,u=K(!1),r=K(i.modelValue);function c(){r.value&&a("update:modelValue",r.value)}const o=$(()=>r.value?new Date(r.value).toLocaleDateString():t("common.noDateSelected"));return(d,v)=>{const f=p("v-btn"),b=p("v-date-picker"),_=p("v-menu");return w(),q("div",zt,[z("label",Et,C(e.title),1),z("div",Ut,[l(_,{modelValue:u.value,"onUpdate:modelValue":v[2]||(v[2]=A=>u.value=A),transition:"scale-transition","offset-y":""},{activator:m(({props:A})=>[l(f,ge(A,{class:"date-btn",variant:"text",ripple:!1,size:"large",text:o.value}),null,16,["text"])]),default:m(()=>[l(b,{modelValue:r.value,"onUpdate:modelValue":[v[0]||(v[0]=A=>r.value=A),c],min:new Date,class:"weekdays-primary","control-variant":"modal",elevation:"1","hide-header":"","show-adjacent-months":"",onInput:v[1]||(v[1]=A=>u.value=!1)},null,8,["modelValue","min"])]),_:1},8,["modelValue"]),l(f,{icon:"mdi-close",color:"red",size:"large",variant:"text",disabled:!r.value,onClick:v[3]||(v[3]=A=>r.value=null),title:"Clear date"},null,8,["disabled"])])])}}}),Ot=J(Dt,[["__scopeId","data-v-42174073"]]),Nt=U({__name:"AddOrderModal",setup(e){const{maxLength:n,required:t}=ie(),{createCreditOrderCommmandHandler:i,partners:a,partnersToItemProps:u}=se(),{tCap:r}=Z(),c=["Credit","Debit"],o=Be({direction:"Credit",partnerId:"",vatRate:.24,dueDate:null,notes:"",depositAmount:0,discountAmount:0,items:[]}),{dialog:d,formRef:v,validForm:f,loading:b,errorMessage:_,close:A,reset:I,submit:y}=Ie(o,{autoReset:!1}),E=K([]);function D(){o.items.push(wt({id:Se(),name:"",variations:[]})),ye(()=>{E.value.push(o.items.length-1)})}const O=$(()=>o.items.reduce((S,h)=>{const N=h.variations?.reduce((Q,T)=>Q+Object.values(T.sizing).reduce((G,j)=>G+j,0),0)??0;return S+N},0)),x=$(()=>o.items.reduce((S,h)=>{const N=h.variations?.reduce((Q,T)=>{const G=Object.values(T.sizing).reduce((j,re)=>j+re,0);return Q+G*T.price},0)??0;return S+N},0)),V=$(()=>x.value*o.vatRate),g=$(()=>x.value+V.value),F=$(()=>g.value-o.discountAmount),W=$(()=>F.value-o.depositAmount);function Y(S){const h=o.items.findIndex(N=>N.id===S);h!=-1&&o.items.splice(h,1)}async function ae(){await y(async S=>{S.direction==="Credit"&&(be(S),i.handle(be(S))),I()})}return(S,h)=>{const N=p("v-btn"),Q=p("v-autocomplete"),T=p("v-col"),G=p("v-select"),j=p("v-row"),re=p("v-expansion-panels"),xe=p("v-textarea"),Ce=p("v-alert"),Te=p("v-container"),ke=p("v-form"),Ae=p("v-card-text"),$e=p("v-spacer"),Re=p("v-card-actions"),ze=p("v-card"),Ee=p("v-dialog");return w(),R(Ee,{modelValue:s(d),"onUpdate:modelValue":h[9]||(h[9]=k=>ve(d)?d.value=k:null),"max-width":"1500"},{activator:m(({props:k})=>[l(N,ge(k,{color:"surface-variant",text:s(r)("order.addOrderTitle"),"prepend-icon":"mdi-plus",variant:"flat"}),null,16,["text"])]),default:m(()=>[l(ze,{title:s(r)("order.addOrderTitle")},{default:m(()=>[l(Ae,null,{default:m(()=>[l(ke,{ref_key:"formRef",ref:v,modelValue:s(f),"onUpdate:modelValue":h[8]||(h[8]=k=>ve(f)?f.value=k:null)},{default:m(()=>[l(Te,{fluid:""},{default:m(()=>[l(j,{dense:""},{default:m(()=>[l(T,{cols:"6"},{default:m(()=>[l(Q,{modelValue:o.partnerId,"onUpdate:modelValue":h[0]||(h[0]=k=>o.partnerId=k),"item-props":s(u),label:s(r)("partner.partner"),items:s(a),rules:[s(t)]},null,8,["modelValue","item-props","label","items","rules"])]),_:1}),l(T,{cols:"6"},{default:m(()=>[l(G,{modelValue:o.direction,"onUpdate:modelValue":h[1]||(h[1]=k=>o.direction=k),label:s(r)("order.direction"),items:c,rules:[s(t)]},null,8,["modelValue","label","rules"])]),_:1}),l(T,{cols:"6"},{default:m(()=>[l(Ot,{modelValue:o.dueDate,"onUpdate:modelValue":h[2]||(h[2]=k=>o.dueDate=k),title:s(r)("order.dueDate")},null,8,["modelValue","title"])]),_:1}),l(T,{cols:"12",class:"d-flex justify-space-between align-center mb-4"},{default:m(()=>[z("h3",null,C(s(r)("order.items")),1),l(N,{color:"indigo",text:s(r)("order.addOrderItemTitle"),"prepend-icon":"mdi-plus",variant:"text",onClick:D},null,8,["text"])]),_:1})]),_:1}),l(j,{dense:""},{default:m(()=>[l(re,{modelValue:E.value,"onUpdate:modelValue":h[3]||(h[3]=k=>E.value=k),multiple:""},{default:m(()=>[(w(!0),q(le,null,oe(o.items,(k,de)=>(w(),R(yt,{key:k.id,modelValue:o.items[de],"onUpdate:modelValue":me=>o.items[de]=me,onRemoveItem:me=>Y(k.id)},null,8,["modelValue","onUpdate:modelValue","onRemoveItem"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(j,{class:"mb-4",justify:"end",align:"center"},{default:m(()=>[l(T,{cols:"auto"},{default:m(()=>[B(C(s(r)("order.orderQuantity"))+": ",1),z("strong",null,C(O.value),1)]),_:1}),l(T,{cols:"auto"},{default:m(()=>[B(C(s(r)("order.orderSum"))+" ",1),z("strong",null,C(x.value.toFixed(2))+"€",1)]),_:1})]),_:1}),l(j,null,{default:m(()=>[l(T,{cols:"6"},{default:m(()=>[l(xe,{modelValue:o.notes,"onUpdate:modelValue":h[4]||(h[4]=k=>o.notes=k),label:s(r)("order.notes"),rules:[s(n)(1e3)],rows:"4",counter:"1000"},null,8,["modelValue","label","rules"])]),_:1}),l(T,{dense:"",cols:"6"},{default:m(()=>[l(j,{class:"mb-4",justify:"end",align:"center"},{default:m(()=>[l(T,{cols:"6"},{default:m(()=>[l(Rt,{modelValue:o.vatRate,"onUpdate:modelValue":h[5]||(h[5]=k=>o.vatRate=k),"base-amount":x.value},null,8,["modelValue","base-amount"])]),_:1}),l(T,{cols:"4"},{default:m(()=>[B(C(s(r)("order.amountAfterTax"))+" ",1),z("strong",null,C(g.value.toFixed(2))+"€",1)]),_:1})]),_:1}),l(j,{class:"mb-4",justify:"end",align:"center"},{default:m(()=>[l(T,{cols:"6"},{default:m(()=>[l(_e,{modelValue:o.discountAmount,"onUpdate:modelValue":h[6]||(h[6]=k=>o.discountAmount=k),"base-amount":g.value,label:s(r)("order.discount")},null,8,["modelValue","base-amount","label"])]),_:1}),l(T,{cols:"4"},{default:m(()=>[B(C(s(r)("order.total"))+": ",1),z("strong",null,C(F.value.toFixed(2))+"€",1)]),_:1})]),_:1}),l(j,{class:"mb-4",justify:"end",align:"center"},{default:m(()=>[l(T,{cols:"6"},{default:m(()=>[l(_e,{modelValue:o.depositAmount,"onUpdate:modelValue":h[7]||(h[7]=k=>o.depositAmount=k),"base-amount":F.value,label:s(r)("order.deposit")},null,8,["modelValue","base-amount","label"])]),_:1}),l(T,{cols:"4"},{default:m(()=>[B(C(s(r)("order.remainingAmount"))+": ",1),z("strong",null,C(W.value.toFixed(2))+"€",1)]),_:1})]),_:1})]),_:1})]),_:1}),s(_)?(w(),R(Ce,{key:0,type:"error",variant:"tonal",density:"compact",class:"mt-2"},{default:m(()=>[B(C(s(_)),1)]),_:1})):M("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(Re,null,{default:m(()=>[l(N,{variant:"tonal",color:"warning",text:s(r)("common.clear"),onClick:s(I)},null,8,["text","onClick"]),l($e),l(N,{variant:"tonal",color:"indigo",text:s(r)("common.save"),loading:s(b),disabled:!s(f)||s(b),onClick:ae},null,8,["text","loading","disabled"]),l(N,{text:s(r)("common.cancel"),color:"red",disabled:s(b),onClick:s(A)},null,8,["text","disabled","onClick"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}}),Bt=J(Nt,[["__scopeId","data-v-191e11ff"]]),It={class:"d-flex justify-space-between align-center mb-4"},St={class:"text-h6"},Ft=U({__name:"OrdersView",setup(e){const{allOrders:n}=se(),{tCap:t}=Z();return(i,a)=>{const u=p("v-card"),r=p("v-container");return w(),R(r,{class:"py-6"},{default:m(()=>[l(u,{class:"pa-4"},{default:m(()=>[z("div",It,[z("h2",St,C(s(t)("order.order",2)),1),l(Bt)]),l(We,{orders:s(n)},null,8,["orders"])]),_:1})]),_:1})}}});export{Ft as default};
